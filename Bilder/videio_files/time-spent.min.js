/*!! Core Analytics v6.13.2 - Copyright (c) 2015-2022 NRK */
this.CA6=this.CA6||{},this.CA6["engagement/time-spent"]=function(){"use strict";var e;e=function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var i in t)n[i]=t[i]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(i){function o(){}function r(n,t,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var u=JSON.stringify(t);/^[\{\[]/.test(u)&&(t=u)}catch(e){}t=i.write?i.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,!0!==r[c]&&(a+="="+r[c].split(";")[0]));return document.cookie=n+"="+t+a}}function u(e,t){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],u=0;u<r.length;u++){var a=r[u].split("="),c=a.slice(1).join("=");t||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var s=n(a[0]);if(c=(i.read||i)(c,s)||n(c),t)try{c=JSON.parse(c)}catch(e){}if(o[s]=c,e===s)break}catch(e){}}return e?o[e]:o}}return o.set=r,o.get=function(e){return u(e,!1)},o.getJSON=function(e){return u(e,!0)},o.remove=function(n,t){r(n,"",e(t,{expires:-1}))},o.defaults={},o.withConverter=t,o}((function(){}))},e(),"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,n){var t=document.createEvent("CustomEvent");n=n||{};return t.initCustomEvent(e,!!n.bubbles,!!n.cancelable,n.detail),t});var n="engagement",t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?"pagehide":"beforeunload";function i(e,n){return e.reduce((function(t,i,o){if(void 0===i||void 0===e[o-1])return t;var r=i-e[o-1];return r>=n?t+n:t+r}),0)}return function(e){var o,r=1e4,u=5e3,a=e.get("gaEmit"),c=[],s=["focus","scroll","resize",n],d=["focus","mousemove","mousedown","keydown"];function v(){f(),l("secondsActive",Math.round(i(c,u)/1e3)),l("secondsVisible",Math.round(i(c,Number.POSITIVE_INFINITY)/1e3)),c.splice(0)}function f(){c.push(Date.now()),void 0===o&&i(c,u)>=r-u&&(o=window.setTimeout((function(){l("secondsActivePing",r/1e3)}),function(e,n,t){if(e>n)throw new Error("min must not be greater than max in clamp(min, max, value)");return t<e?e:t>n?n:t}(0,Number.POSITIVE_INFINITY,Math.min(u,r))))}function m(){"visible"===document.visibilityState?f():(c.push(Date.now()),c.push(void 0))}function l(n,t){e("event.personalization",{ga:{eventCategory:"content-consumed",eventAction:n,eventValue:t,nonInteraction:!0}})}a?(e.ENGAGEMENT_EVENT=new CustomEvent(n,{bubbles:!0}),e.on("time-spent",(function(n){void 0===n&&(n={});if(c.length)return void e("error",new Error("«time-spent» is already initialized"));f(),n.inactivityThreshold&&(u=n.inactivityThreshold);n.pingThreshold&&(r=n.pingThreshold);n.touchMove&&d.push("touchmove");if(n.ludoInstance)n.ludoInstance.on("timeupdate",f);else{var i=(a=f,l=500,p=!1,function(){var e=arguments,n=this;p||(a.apply(n,e),p=!0,setTimeout((function(){p=!1}),l))}),o=!!function(){var e=!1;try{var n={get passive(){return e=!0,!1}};return window.addEventListener("test",null,n),window.removeEventListener("test",null,n),e}catch(n){return e}}()&&{passive:!0};s.forEach((function(e){return window.addEventListener(e,i,o)})),d.forEach((function(e){return document.addEventListener(e,i,o)}))}var a,l,p;document.addEventListener("visibilitychange",m),window.addEventListener(t,v)})),e.on("time-spent.completed",v)):e("error",new Error("«time-spent» requires a Google Analytics tracking id"))}}();
//# sourceMappingURL=time-spent.min.js.map
