/** nrk.no - 618112c1d5dcb06e487079f2_generation2_20231010T1111 - Kilkaya AS - Copyright 2023 - Config:nrkno */
(()=>{"use strict";function t(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var e=0;function i(t){return"__private_"+e+++"_"+t}var s=i("k5a"),r=i("hookAbleEvents"),a=i("delayEventCnt"),o=i("currHref"),n=i("prevHref"),l=i("hookMap"),h=i("callBacks"),c=i("lastClickTime"),d=i("clickTTL"),u=i("exitType"),p=i("forceDOMContentLoaded"),f=i("initUrls"),g=i("getLocationHref"),v=i("isNewUrl"),b=i("addSPASupport"),y=i("handleSPATransition"),m=i("calcExitType"),w=i("handleEvent"),k=i("execDelayHook"),O=i("execHook"),P=i("execute"),j=i("runDebug"),D=i("eventDebug");class S{constructor(e){Object.defineProperty(this,D,{value:H}),Object.defineProperty(this,j,{value:R}),Object.defineProperty(this,P,{value:U}),Object.defineProperty(this,O,{value:F}),Object.defineProperty(this,k,{value:N}),Object.defineProperty(this,w,{value:I}),Object.defineProperty(this,m,{value:L}),Object.defineProperty(this,y,{value:M}),Object.defineProperty(this,b,{value:C}),Object.defineProperty(this,v,{value:E}),Object.defineProperty(this,g,{value:_}),Object.defineProperty(this,f,{value:T}),Object.defineProperty(this,p,{value:A}),Object.defineProperty(this,s,{writable:!0,value:null}),Object.defineProperty(this,r,{writable:!0,value:{ready:[],active:[],hidden:[],pageView:[],click:[],exit:[],scroll:[],activity:[],spa:[]}}),Object.defineProperty(this,a,{writable:!0,value:0}),Object.defineProperty(this,o,{writable:!0,value:location.href}),Object.defineProperty(this,n,{writable:!0,value:null}),Object.defineProperty(this,l,{writable:!0,value:{blur:{hooks:["hidden"]},hidden:{hooks:["hidden"]},active:{hooks:["active"]},focus:{hooks:["active"]},loading:{hooks:["pageView"]},interactive:{hooks:["pageView","ready"]},complete:{hooks:["pageView","ready"]},DOMContentLoaded:{hooks:["pageView","ready"]},pageshow:{hooks:["pageView","ready"]},click:{hooks:["click"]},pagehide:{hooks:["exit"]},scroll:{hooks:["scroll","activity"],delay:!0},mousemove:{hooks:["activity"],delay:!0},mousedown:{hooks:["click"],delay:!1},mouseup:{hooks:["activity"],delay:!0},touchstart:{hooks:["activity"],delay:!0},touchend:{hooks:["activity"],delay:!0},keyup:{hooks:["activity"],delay:!0},keydown:{hooks:["activity"],delay:!0},spa:{hooks:["spa"]}}}),Object.defineProperty(this,h,{writable:!0,value:{interactive:[],load:[],loaded:[],click:[]}}),Object.defineProperty(this,c,{writable:!0,value:0}),Object.defineProperty(this,d,{writable:!0,value:301}),Object.defineProperty(this,u,{writable:!0,value:"exit"}),t(this,s)[s]=e,t(this,f)[f](),e.cfg&&e.cfg.clickTTL&&e.cfg.clickTTL>t(this,d)[d]&&(t(this,d)[d]=e.cfg.clickTTL,t(this,s)[s].speaker.say("Click TTL: "+t(this,d)[d],"listener")),window.addEventListener("DOMContentLoaded",t(this,w)[w].bind(this),!0),t(this,s)[s].element.addEventListener("readystatechange",t(this,w)[w].bind(this),!0),t(this,s)[s].element.addEventListener("visibilitychange",t(this,w)[w].bind(this),!0),t(this,s)[s].element.addEventListener("click",t(this,w)[w].bind(this),!1),t(this,s)[s].element.addEventListener("scroll",t(this,w)[w].bind(this),!1),t(this,s)[s].element.addEventListener("mousemove",t(this,w)[w].bind(this),!0),t(this,s)[s].element.addEventListener("mousedown",t(this,w)[w].bind(this),!0),window.addEventListener("pageshow",t(this,w)[w].bind(this),!0),window.addEventListener("pagehide",t(this,w)[w].bind(this),{capture:!0}),window.addEventListener("blur",t(this,w)[w].bind(this),!0),window.addEventListener("focus",t(this,w)[w].bind(this),!0),t(this,b)[b]()}postInitialize(){if(!document.readyState||"complete"!==document.readyState&&"loaded"!==document.readyState&&"interactive"!==document.readyState)setTimeout(function(){t(this,p)[p]()}.bind(this),500);else{t(this,s)[s].speaker.say("postInitialize firing DOMContentLoaded:"+document.readyState);try{t(this,p)[p]()}catch(e){console.log("Error creating event[1]: "+e.toString()),setTimeout(function(){t(this,p)[p]()}.bind(this),500)}}}getCurrentUrl(){return t(this,o)[o]}getPrevUrl(){return t(this,n)[n]}fireHook(e){if(t(this,l)[l][e])try{var i=document.createEvent("Event");i.initEvent(e,!0,!0),t(this,O)[O](e,i)}catch(t){console.log("Could not run fireHook on '"+e+"': "+t.toString())}}addHook(e,i,s=!1){"activity"!=e&&"spa"!=e||(s=!0),t(this,r)[r][e].push({callBack:i,done:!1,reuse:s})}getExitType(){return t(this,u)[u]}}function A(){try{var e=document.createEvent("Event");e.initEvent("DOMContentLoaded",!0,!0),t(this,O)[O]("DOMContentLoaded",e)}catch(t){console.log("Could not run forced event: "+t.toString())}}function T(){t(this,o)[o]=t(this,g)[g](),t(this,n)[n]=null}function _(){let e=location.href.replace(/\/$/,"");return t(this,s)[s].cfg.pageData.SPA&&(t(this,s)[s].cfg.pageData.SPA.ignoreAnchor&&!0===t(this,s)[s].cfg.pageData.SPA.ignoreAnchor&&(e=e.replace(/\#[^&]+/,"")),t(this,s)[s].cfg.pageData.SPA.ignoreQSP&&!0===t(this,s)[s].cfg.pageData.SPA.ignoreQSP&&(e=e.replace(/[\#\?\&].+/,""))),e}function E(){var e=t(this,g)[g]();return t(this,o)[o]!==e&&(t(this,n)[n]=t(this,o)[o],t(this,o)[o]=e,!0)}function C(){t(this,s)[s].cfg.pageData&&t(this,s)[s].cfg.pageData.SPA&&(t(this,s)[s].cfg.pageData.SPA.customEvent&&""!==t(this,s)[s].cfg.pageData.SPA.customEvent?(t(this,s)[s].speaker.say("Setting up SPA with customEvent: "+t(this,s)[s].cfg.pageData.SPA.customEvent,"listener"),t(this,s)[s].element.addEventListener(t(this,s)[s].cfg.pageData.SPA.customEvent,(e=>{t(this,s)[s].speaker.say("GOT SPA Event: "+t(this,o)[o]+" vs "+location.href+" "+t(this,c)[c]+" "+e.timeStamp),(t(this,v)[v]()||t(this,s)[s].cfg.pageData.SPA.forcedSPA)&&(t(this,m)[m](e.timeStamp),t(this,y)[y](!0))}),!0)):"MutationObserver"in window?new MutationObserver(function(e){if(t(this,s)[s].cfg.pageData.SPA.triggers&&""!=t(this,s)[s].cfg.pageData.SPA.triggers){for(var i=0;i<e.length;i++)if(e[i].target&&e[i].target.tagName){let a=[];if("head"==e[i].target.tagName.toLowerCase()&&e[i].addedNodes.length>0)for(let t=0;t<e[i].addedNodes.length;t++)"meta"==e[i].addedNodes[t].tagName.toLowerCase()&&a.push(e[i].addedNodes[t]);else"meta"==e[i].target.tagName.toLowerCase()&&a.push(e[i].target);for(let e=0;e<a.length;e++){var r=a[e].getAttribute("property");null==r&&(r=a[e].getAttribute("name")),r&&""!=r&&null!==r.match(new RegExp(t(this,s)[s].cfg.pageData.SPA.triggers))&&(t(this,s)[s].speaker.say('SPA mutation: got a match: "'+r+'" matched with: "'+t(this,s)[s].cfg.pageData.SPA.triggers+'"'),t(this,y)[y]())}}}else t(this,y)[y]()}.bind(this)).observe(document.documentElement||document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0}):this.addHook("activity",function(e){window.requestIdleCallback((()=>{t(this,y)[y]()}))}.bind(this),!0))}function M(e=!1){(t(this,v)[v]()||e)&&setTimeout(function(){t(this,s)[s].cfg.pageData.SPA&&!1!==t(this,s)[s].cfg.pageData.SPA.metaData?t(this,s)[s].pageData.reRead():t(this,s)[s].pageData.setField("url",t(this,o)[o]),t(this,s)[s].resetRequestId(),t(this,O)[O]("spa",new CustomEvent("spa",{detail:{sourceUrl:t(this,n)[n],targetUrl:t(this,o)[o]}}),!0)}.bind(this),t(this,s)[s].cfg.pageData.SPA&&t(this,s)[s].cfg.pageData.SPA.delayEvent&&t(this,s)[s].cfg.pageData.SPA.delayEvent>0?1e3*t(this,s)[s].cfg.pageData.SPA.delayEvent:1)}function L(e){t(this,c)[c]>0&&e>0&&e>=t(this,c)[c]&&e-t(this,c)[c]<=t(this,d)[d]?t(this,u)[u]="click":t(this,u)[u]="exit"}function I(e){switch(e.type){case"pagehide":t(this,m)[m](e.timeStamp),t(this,O)[O](e.type,e);break;case"readystatechange":let i=e.target.readyState;void 0!==t(this,l)[l][i]&&t(this,O)[O](i,e),"complete"==e.target.readyState&&(t(this,P)[P]("interactive",e),t(this,P)[P]("loaded",e));break;case"pageshow":t(this,O)[O](e.type,e,e.persisted);break;case"visibilitychange":t(this,D)[D]("visibility: "+document.visibilityState),t(this,O)[O]("visible"===document.visibilityState?"active":"hidden",e,!0);break;case"click":case"mousedown":if("click"==e.type&&t(this,c)[c]>0&&t(this,c)[c]>=e.timeStamp-t(this,d)[d])return void t(this,s)[s].speaker.say("event is click and we just did a mousedown event on this click","listener");t(this,c)[c]=e.timeStamp,t(this,m)[m](e.timeStamp),t(this,O)[O](e.type,e);break;case"DOMContentLoaded":case"mousemove":case"mouseup":case"scroll":case"beforeunload":case"blur":case"focus":t(this,l)[l][e.type].delay?(t(this,a)[a]++,setTimeout(t(this,k)[k].bind(this,e.type,e,t(this,a)[a]),100)):t(this,O)[O](e.type,e);break;default:t(this,s)[s].speaker.say("Don't know how to handle this event: "+e.type)}}function N(e,i,s){s===t(this,a)[a]&&t(this,O)[O](i.type,i)}function F(e,i,a=!1){if(t(this,s)[s].speaker.say("Got hook: "+e,"listener"),void 0!==t(this,l)[l][e]){"pageView"!==t(this,l)[l][e]&&"spa"!==t(this,l)[l][e]||this.k5a.resetRequestId();for(var o=0;o<t(this,l)[l][e].hooks.length;o++){let h=t(this,l)[l][e].hooks[o];for(var n=0;n<t(this,r)[r][h].length;n++)if(0==t(this,r)[r][h][n].done||1==a)try{t(this,r)[r][h][n].callBack(i),t(this,r)[r][h][n].reuse||(t(this,r)[r][h][n].done=!0)}catch(e){t(this,s)[s].speaker.say("Could not execute callback....."+e.toString(),"listener")}else t(this,s)[s].speaker.say("["+i.type+"]Hook already done: "+h,"listener");t(this,s)[s].logger.fire(h,i.source||"js",i.type)}}else t(this,s)[s].speaker.say("undefined hook: "+e,"listener")}function U(e,i){for(var s=0;s<t(this,h)[h][e].length;s++)0==t(this,h)[h][e][s].done&&(t(this,h)[h][e][s].callback(i),t(this,h)[h][e][s].done=!0)}function R(t){var e=document.getElementById("evtDebug");null===e&&((e=document.createElement("DIV")).id="evtDebug",e.style="background:grey;color:white;padding:5px;position:fixed;bottom:10px;right:10px;width:250px;min-height:30px;font-size:12px;opacity:0.85;",document.body.appendChild(e)),e.innerHTML+="<li>"+t.type+" "+document.visibilityState}function H(t){}function q(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var V=0;function B(t){return"__private_"+V+++"_"+t}var K=B("debugMode"),z=B("devMode"),$=B("debugUrl"),Y=B("prefix"),J=B("k5a"),W=B("debugModules"),G=B("getCaller"),Z=B("canDebug"),Q=B("logold"),X=B("log");class tt{constructor(t=null,e=!1,i=!1){Object.defineProperty(this,X,{value:rt}),Object.defineProperty(this,Q,{value:st}),Object.defineProperty(this,Z,{value:it}),Object.defineProperty(this,G,{value:et}),Object.defineProperty(this,K,{writable:!0,value:!0}),Object.defineProperty(this,z,{writable:!0,value:!1}),Object.defineProperty(this,$,{writable:!0,value:!1}),Object.defineProperty(this,Y,{writable:!0,value:"K5A"}),Object.defineProperty(this,J,{writable:!0,value:null}),Object.defineProperty(this,W,{writable:!0,value:{}}),q(this,J)[J]=t,q(this,z)[z]=i,this.debugMode=e,this.initModes()}set debugUrl(t=!1){q(this,$)[$]=t}set debugMode(t=!1){q(this,K)[K]=t,t&&this.say("Debug mode is on!")}set devMode(t=!1){t&&(this.say("Dev mode is on!"),q(this,z)[z]=t)}get debugMode(){return q(this,K)[K]}getDebugModeModule(t){return q(this,Z)[Z](t)}setDebugModeModule(t,e=!0){""!==t&&t.length>3&&(q(this,W)[W][t]=e,q(this,K)[K]=!0)}initModes(){if(location.href.indexOf("k5aDebug")>-1){let e=new URL(location.href),i=e.searchParams.get("k5aDebug");if(i.indexOf("|")>-1||i.length>3){let e=i.split("|");for(var t=0;t<e.length;t++)q(this,W)[W][e[t].trim()]=!0,q(this,K)[K]=!0;this.say("Debugmode ON for: ["+e.join(" ")+"]","k5a")}else"1"!==i&&"true"!==i||(q(this,K)[K]=!0);let s=e.searchParams.get("k5aDebugDev");"1"!==s&&"true"!==s||(q(this,z)[z]=!0,this.say("Dev mode ON","k5a"))}}setPersistentDebugMode(t=!1,e=!1){if(t){var i=e?2:1;q(this,J)[J].storage.setKey("dbg",i,3600),this.debugMode=!0,this.say("Persistent debug mode initialized","k5a")}else q(this,J)[J].storage.delKey("dbg")}checkPersistentDebugMode(){if(q(this,J)[J].storage&&q(this,J)[J].storage.canStore()){var t=q(this,J)[J].storage.getKey("dbg");t&&(t>1?(this.debugMode=!0,this.devMode=!0):1===t&&(this.devMode=!1,this.debugMode=!0))}}say(t,e="k5a"){q(this,K)[K]&&q(this,X)[X](t,"info",e)}info(t,e="k5a"){q(this,X)[X](t,"info",e)}error(t,e="k5a"){q(this,X)[X](t,"error",e)}warn(t,e="k5a"){q(this,X)[X](t,"warn",e)}table(t,e="k5a"){q(this,Z)[Z](e)&&(console.table?console.table(t):console.debug(JSON.stringify(t)))}dump(t){q(this,K)[K]&&(q(this,z)[z]?console.trace(q(this,Y)[Y],t):console.debug(q(this,Y)[Y],t))}}function et(){let t=((new Error).stack||"").split("\n");for(var e=1;e<t.length;e++)if(-1===t[e].indexOf("speaker2.js")||e+1==t.length)return t[e].trim();return""}function it(t){return!(!q(this,K)[K]||Object.keys(q(this,W)[W]).length>0&&(void 0===q(this,W)[W][t]||!1===q(this,W)[W][t]))}function st(t){q(this,z)[z]?console.trace(q(this,Y)[Y],t):console.log(q(this,Y)[Y],t),!1!==q(this,$)[$]&&((new Image).src=q(this,$)[$]+"?"+t)}function rt(t,e="info",i=null){let s="";if("object"==typeof t&&(void 0!==t.prefix&&(s=t.prefix),e=t.type,i=t.module,t=t.message),q(this,Z)[Z](i)||"error"==e){let r="font-weight:bold;color:#284352;",a={info:"blue",error:"red",warn:"orange"},o=q(this,Y)[Y]+(null!==i?"["+i+"]":"")+s;if("error"===e?console.error("%c"+o+": %c"+t,r,"color:"+a[e]):console.log("%c"+o+": %c"+t,r,"color:"+a[e]),q(this,z)[z]){let t=q(this,G)[G]();console.log("%c"+o+": %c \\-> "+t,r,"color:"+a[e])}}}function at(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ot=0;function nt(t){return"__private_"+ot+++"_"+t}var lt=nt("k5a"),ht=nt("data"),ct=nt("hookMap"),dt=nt("loggerEnabled"),ut=nt("useRateLimiter"),pt=nt("reqCnt"),ft=nt("reqLastCheckTime"),gt=nt("reqFastReqCnt"),vt=nt("totalMaxRequest"),bt=nt("timeMaxRequest"),yt=nt("timeRequestsCnt"),mt=nt("compileLogdata"),wt=nt("checkRateLimits");class kt{constructor(t){Object.defineProperty(this,wt,{value:Pt}),Object.defineProperty(this,mt,{value:Ot}),Object.defineProperty(this,lt,{writable:!0,value:null}),Object.defineProperty(this,ht,{writable:!0,value:{}}),Object.defineProperty(this,ct,{writable:!0,value:{pageView:"p",click:"c",exit:"e",activity:"a",video:"v",nisa:"n"}}),Object.defineProperty(this,dt,{writable:!0,value:!0}),Object.defineProperty(this,ut,{writable:!0,value:!1}),Object.defineProperty(this,pt,{writable:!0,value:0}),Object.defineProperty(this,ft,{writable:!0,value:null}),Object.defineProperty(this,gt,{writable:!0,value:0}),Object.defineProperty(this,vt,{writable:!0,value:1e3}),Object.defineProperty(this,bt,{writable:!0,value:10}),Object.defineProperty(this,yt,{writable:!0,value:10}),at(this,lt)[lt]=t,void 0!==at(this,lt)[lt].cfg.rateLimiter&&(at(this,ut)[ut]=!!at(this,lt)[lt].cfg.rateLimiter.enabled,at(this,ut)[ut]&&at(this,lt)[lt].speaker.say("Using ratelimiter with these settings: "+JSON.stringify(at(this,lt)[lt].cfg.rateLimiter),"logger"),void 0!==at(this,lt)[lt].cfg.rateLimiter.maxRequests&&(at(this,vt)[vt]=at(this,lt)[lt].cfg.rateLimiter.maxRequests),void 0!==at(this,lt)[lt].cfg.rateLimiter.throttlingTime&&(at(this,bt)[bt]=at(this,lt)[lt].cfg.rateLimiter.throttlingTime),void 0!==at(this,lt)[lt].cfg.rateLimiter.throttlingCount&&(at(this,yt)[yt]=at(this,lt)[lt].cfg.rateLimiter.throttlingCount))}disable(){at(this,dt)[dt]=!1}enable(){at(this,dt)[dt]=!0}fireNow(t,e,i,s="c"){this.addData(t,e),this.fire(t,i,s)}addData(t,e){at(this,lt)[lt].speaker.say("adding data for: "+t,"logger"),at(this,lt)[lt].speaker.table(e,"logger"),void 0===at(this,ht)[ht][t]?at(this,ht)[ht][t]=e:at(this,ht)[ht][t]={...at(this,ht)[ht][t],...e}}fire(t,e="",i=""){if(void 0!==at(this,ht)[ht][t]){var s=at(this,ht)[ht][t];delete at(this,ht)[ht][t],void 0!==at(this,ct)[ct][t]&&(s.l=at(this,ct)[ct][t]),void 0!==s._h&&""!==s._h||(s._h=t),void 0!==s._s&&""!==s._s||(s._s=e),void 0!==s._l&&""!==s._l||(s._l=i),at(this,pt)[pt]++,s._c=at(this,pt)[pt],at(this,wt)[wt](),this.doLog(s)}}doLog(t){if(0==at(this,dt)[dt])return;let e=at(this,mt)[mt](t);at(this,lt)[lt].speaker.say("full send: "+e);try{if(navigator&&navigator.sendBeacon)return navigator.sendBeacon(e+"&_m=b",{});var i=(new Date).getTime();return(new Image).src=e+"&_m=i&_r="+i,!0}catch(t){console.error(t.toString())}}doPostLog(t){if(at(this,wt)[wt](),0!=at(this,dt)[dt])try{if(navigator&&navigator.sendBeacon){at(this,pt)[pt]++;var e=[];if(void 0===t.l)return console.error("Missing logType!"),!1;e.push("l="+t.l),["_h","_s","_l"].forEach((function(i,s){void 0===t[i]&&(t[i]=""),e.push(i+"="+t[i])})),e.push("_m=b"),e.push("_c="+at(this,pt)[pt]),t.i=at(this,lt)[lt].cfg.installationId,navigator.sendBeacon(at(this,lt)[lt].k5aServer+"p?i="+at(this,lt)[lt].cfg.installationId+"&"+e.join("&"),JSON.stringify(t))}}catch(t){console.error(t.toString())}}}function Ot(t){for(var e in t)t[e]instanceof Array&&(t[e]=t[e].join("|"));var i="";void 0!==t.l&&(i="&l="+t.l,delete t.l);var s=Object.keys(t).map((e=>e+"="+encodeURIComponent(t[e]))).join("&");return at(this,lt)[lt].k5aServer+"?i="+at(this,lt)[lt].cfg.installationId+i+"&"+s}function Pt(){if(at(this,ut)[ut]){if(null===at(this,ft)[ft])return void(at(this,ft)[ft]=parseInt((new Date).getTime()/1e3));let t=parseInt((new Date).getTime()/1e3);t-at(this,ft)[ft]<=at(this,bt)[bt]?(at(this,gt)[gt]++,at(this,gt)[gt]>=at(this,yt)[yt]&&(at(this,dt)[dt]?(at(this,lt)[lt].speaker.say("Throttling log requests, execeed limits with "+at(this,gt)[gt]+" of "+at(this,yt)[yt]+" the last "+at(this,bt)[bt]+" seconds","logger"),this.disable()):at(this,lt)[lt].speaker.say("Log requests is throttled, execeed limits with "+at(this,gt)[gt]+" of "+at(this,yt)[yt]+" the last "+at(this,bt)[bt]+" seconds","logger"))):(at(this,gt)[gt]=0,!1===at(this,dt)[dt]&&at(this,pt)[pt]<at(this,vt)[vt]&&(at(this,lt)[lt].speaker.say("Reenabling logging again","logger"),this.enable())),at(this,ft)[ft]=t,at(this,pt)[pt]>at(this,vt)[vt]&&at(this,lt)[lt].speaker.warn("This client execeded max total log requests - "+at(this,pt)[pt]+" of max "+at(this,vt)[vt],"logger")}}function jt(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Dt=0;function St(t){return"__private_"+Dt+++"_"+t}var At=St("url");class Tt{constructor(t=null){Object.defineProperty(this,At,{writable:!0,value:""}),null!==t&&null!==t.match(/^\/\//i)&&(t=location.protocol+"//"+t);try{var e;jt(this,At)[At]=new URL(null!=(e=t)?e:location.href)}catch(e){var i;console.error("Invalid url given '"+(null!=(i=t)?i:location.href)+"' "+e.toString())}}get isLink(){return 0==jt(this,At)[At].href.toLowerCase().indexOf("http",0)}get domain(){return jt(this,At)[At].hostname.split(".").slice(-2).join(".")}get hash(){return jt(this,At)[At].hash}get host(){return jt(this,At)[At].host}get hostname(){return jt(this,At)[At].hostname}get href(){return jt(this,At)[At].href}get origin(){return jt(this,At)[At].origin}get password(){return jt(this,At)[At].password}get pathname(){return jt(this,At)[At].pathname}get port(){return jt(this,At)[At].port}get protocol(){return jt(this,At)[At].port}get search(){return jt(this,At)[At].search}get searchParams(){return jt(this,At)[At].searchParams}get clean(){return jt(this,At)[At].href.split(/[?#]/)[0]}}function _t(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Et=0;function Ct(t){return"__private_"+Et+++"_"+t}var xt=Ct("f"),Mt=Ct("keyStrBase64"),Lt=Ct("keyStrUriSafe"),It=Ct("baseReverseDic");class Nt{constructor(){Object.defineProperty(this,xt,{writable:!0,value:String.fromCharCode}),Object.defineProperty(this,Mt,{writable:!0,value:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}),Object.defineProperty(this,Lt,{writable:!0,value:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"}),Object.defineProperty(this,It,{writable:!0,value:{}})}getBaseValue(t,e){if(!_t(this,It)[It][t]){_t(this,It)[It][t]={};for(var i=0;i<t.length;i++)_t(this,It)[It][t][t.charAt(i)]=i}return _t(this,It)[It][t][e]}compressToBase64(t){if(null==t)return"";var e=this._compress(t,6,function(t){return _t(this,Mt)[Mt].charAt(t)}.bind(this));switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}}decompressFromBase64(t){return null==t?"":""==t?null:this._decompress(t.length,32,function(e){return getBaseValue(_t(this,Mt)[Mt],t.charAt(e))}.bind(this))}compressToUTF16(t){return null==t?"":this._compress(t,15,function(t){return _t(this,xt)[xt](t+32)}.bind(this))+" "}decompressFromUTF16(t){return null==t?"":""==t?null:this._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32}.bind(t))}compressToUint8Array(t){for(var e=this.compress(t),i=new Uint8Array(2*e.length),s=0,r=e.length;s<r;s++){var a=e.charCodeAt(s);i[2*s]=a>>>8,i[2*s+1]=a%256}return i}decompressFromUint8Array(t){if(null==t)return this.decompress(t);for(var e=new Array(t.length/2),i=0,s=e.length;i<s;i++)e[i]=256*t[2*i]+t[2*i+1];var r=[];return e.forEach(function(t){r.push(_t(this,xt)[xt](t))}.bind(this)),this.decompress(r.join(""))}compressToEncodedURIComponent(t){return null==t?"":this._compress(t,6,function(t){return _t(this,Lt)[Lt].charAt(t)}.bind(this))}decompressFromEncodedURIComponent(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),this._decompress(t.length,32,function(e){return getBaseValue(_t(this,Lt)[Lt],t.charAt(e))}.bind(this)))}compress(t){return this._compress(t,16,function(t){return _t(this,xt)[xt](t)}.bind(this))}_compress(t,e,i){if(null==t)return"";var s,r,a,o={},n={},l="",h="",c="",d=2,u=3,p=2,f=[],g=0,v=0;for(a=0;a<t.length;a+=1)if(l=t.charAt(a),Object.prototype.hasOwnProperty.call(o,l)||(o[l]=u++,n[l]=!0),h=c+l,Object.prototype.hasOwnProperty.call(o,h))c=h;else{if(Object.prototype.hasOwnProperty.call(n,c)){if(c.charCodeAt(0)<256){for(s=0;s<p;s++)g<<=1,v==e-1?(v=0,f.push(i(g)),g=0):v++;for(r=c.charCodeAt(0),s=0;s<8;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1}else{for(r=1,s=0;s<p;s++)g=g<<1|r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r=0;for(r=c.charCodeAt(0),s=0;s<16;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1}0==--d&&(d=Math.pow(2,p),p++),delete n[c]}else for(r=o[c],s=0;s<p;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1;0==--d&&(d=Math.pow(2,p),p++),o[h]=u++,c=String(l)}if(""!==c){if(Object.prototype.hasOwnProperty.call(n,c)){if(c.charCodeAt(0)<256){for(s=0;s<p;s++)g<<=1,v==e-1?(v=0,f.push(i(g)),g=0):v++;for(r=c.charCodeAt(0),s=0;s<8;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1}else{for(r=1,s=0;s<p;s++)g=g<<1|r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r=0;for(r=c.charCodeAt(0),s=0;s<16;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1}0==--d&&(d=Math.pow(2,p),p++),delete n[c]}else for(r=o[c],s=0;s<p;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(r=2,s=0;s<p;s++)g=g<<1|1&r,v==e-1?(v=0,f.push(i(g)),g=0):v++,r>>=1;for(;;){if(g<<=1,v==e-1){f.push(i(g));break}v++}return f.join("")}decompress(t){return null==t?"":""==t?null:this._decompress(t.length,32768,function(e){return t.charCodeAt(e)}.bind(t))}_decompress(t,e,i){var s,r,a,o,n,l,h,c=[],d=4,u=4,p=3,f="",g=[],v={val:i(0),position:e,index:1};for(s=0;s<3;s+=1)c[s]=s;for(a=0,n=Math.pow(2,2),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;switch(a){case 0:for(a=0,n=Math.pow(2,8),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;h=_t(this,xt)[xt](a);break;case 1:for(a=0,n=Math.pow(2,16),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;h=_t(this,xt)[xt](a);break;case 2:return""}for(c[3]=h,r=h,g.push(h);;){if(v.index>t)return"";for(a=0,n=Math.pow(2,p),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;switch(h=a){case 0:for(a=0,n=Math.pow(2,8),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;c[u++]=_t(this,xt)[xt](a),h=u-1,d--;break;case 1:for(a=0,n=Math.pow(2,16),l=1;l!=n;)o=v.val&v.position,v.position>>=1,0==v.position&&(v.position=e,v.val=i(v.index++)),a|=(o>0?1:0)*l,l<<=1;c[u++]=_t(this,xt)[xt](a),h=u-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,p),p++),c[h])f=c[h];else{if(h!==u)return null;f=r+r.charAt(0)}g.push(f),c[u++]=r+f.charAt(0),r=f,0==--d&&(d=Math.pow(2,p),p++)}}}function Ft(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Ut=0;function Rt(t){return"__private_"+Ut+++"_"+t}var Ht=Rt("storageName"),qt=Rt("storageMode"),Vt=Rt("sameSite"),Bt=Rt("domain"),Kt=Rt("canStore"),zt=Rt("useBinary"),$t=Rt("useBase64"),Yt=Rt("buckSize"),Jt=Rt("buckCnt"),Wt=Rt("dataSet"),Gt=Rt("k5a"),Zt=Rt("checkStorage"),Qt=Rt("getData"),Xt=Rt("saveData"),te=Rt("getCookie"),ee=Rt("saveToCookie"),ie=Rt("resetCookie"),se=Rt("setCookie");class re{constructor(t,e="_k5a",i="cookie"){Object.defineProperty(this,se,{value:de}),Object.defineProperty(this,ie,{value:ce}),Object.defineProperty(this,ee,{value:he}),Object.defineProperty(this,te,{value:le}),Object.defineProperty(this,Xt,{value:ne}),Object.defineProperty(this,Qt,{value:oe}),Object.defineProperty(this,Zt,{value:ae}),Object.defineProperty(this,Ht,{writable:!0,value:"_k5a"}),Object.defineProperty(this,qt,{writable:!0,value:"cookie"}),Object.defineProperty(this,Vt,{writable:!0,value:"Strict"}),Object.defineProperty(this,Bt,{writable:!0,value:""}),Object.defineProperty(this,Kt,{writable:!0,value:!1}),Object.defineProperty(this,zt,{writable:!0,value:!1}),Object.defineProperty(this,$t,{writable:!0,value:!1}),Object.defineProperty(this,Yt,{writable:!0,value:950}),Object.defineProperty(this,Jt,{writable:!0,value:4}),Object.defineProperty(this,Wt,{writable:!0,value:null}),Object.defineProperty(this,Gt,{writable:!0,value:null}),e!==Ft(this,Ht)[Ht]&&""!==e?Ft(this,Ht)[Ht]=e:void 0!==t&&void 0!==t.cfg.storage&&(void 0!==t.cfg.storage.name&&(Ft(this,Ht)[Ht]=t.cfg.storage.name),void 0!==t.cfg.storage.type&&"localstorage"==t.cfg.storage.type&&(i="localstorage"),void 0!==t.cfg.storage.b64&&t.cfg.storage.b64&&(Ft(this,$t)[$t]=!0,t.speaker.say("storage: b64 on")),void 0!==t.cfg.storage.compress&&t.cfg.storage.compress&&(Ft(this,zt)[zt]=!0,t.speaker.say("storage: compress on"))),i!=Ft(this,qt)[qt]&&(Ft(this,qt)[qt]=i),Ft(this,Gt)[Gt]=t;let s=new Tt(location.href);Ft(this,Bt)[Bt]=s.domain,Ft(this,Kt)[Kt]=Ft(this,Zt)[Zt](),t.speaker.say("Can store : "+(Ft(this,Kt)[Kt]?"yes":"no")+" storageMode:"+Ft(this,qt)[qt]),Ft(this,Wt)[Wt]=Ft(this,Qt)[Qt]()}canStore(){return Ft(this,Kt)[Kt]}get(){return Ft(this,Wt)[Wt]}set(t){Ft(this,Wt)[Wt]=t,Ft(this,Xt)[Xt]()}getKey(t){return null==Ft(this,Wt)[Wt]&&(Ft(this,Wt)[Wt]=Ft(this,Qt)[Qt]()),null!==Ft(this,Wt)[Wt]&&void 0!==Ft(this,Wt)[Wt][t]?Ft(this,Wt)[Wt][t][1]>0&&parseInt((new Date).getTime()/1e3)>Ft(this,Wt)[Wt][t][1]?(delete Ft(this,Wt)[Wt][t],Ft(this,Xt)[Xt](),null):Ft(this,Wt)[Wt][t][0]:null}setKey(t,e,i=0){null==Ft(this,Wt)[Wt]&&(Ft(this,Wt)[Wt]=Ft(this,Qt)[Qt]()),Ft(this,Wt)[Wt][t]=[e,i>0?parseInt((new Date).getTime()/1e3)+i:0],Ft(this,Xt)[Xt]()}delKey(t){null==Ft(this,Wt)[Wt]&&(Ft(this,Wt)[Wt]=Ft(this,Qt)[Qt]());try{delete Ft(this,Wt)[Wt][t]}catch(e){console.log("could not delete key: "+t)}Ft(this,Xt)[Xt]()}}function ae(){var t=!1;if("cookie"===Ft(this,qt)[qt]){if(navigator&&navigator.cookieEnabled&&(t=!0),!t){var e="__t"+(new Date).getTime();document.cookie=e+"=1",t=-1!==document.cookie.indexOf(e+"="),document.cookie=e+"=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"}}else if("localstorage"===Ft(this,qt)[qt]){t=!1;try{t="object"==(typeof window.localStorage).toLowerCase()}catch(t){console.log("No access to localStorage")}}return t}function oe(){let t;if("localstorage"==Ft(this,qt)[qt]){if(t=localStorage.getItem(Ft(this,Ht)[Ht]),Ft(this,zt)[zt]){let e=(new Nt).decompress(t);null!==e&&(t=e)}}else if(t=Ft(this,te)[te](Ft(this,Ht)[Ht]),Ft(this,$t)[$t]&&null!==t)try{t=decodeURIComponent(atob(t))}catch(t){console.error(t.toString())}if(null==t)return{};try{return JSON.parse(t)}catch(t){console.log("error in data: "+t.toString()),"localstorage"!==Ft(this,qt)[qt]&&Ft(this,ie)[ie]()}return{}}function ne(){let t=JSON.stringify(Ft(this,Wt)[Wt]);"localstorage"==Ft(this,qt)[qt]?(Ft(this,zt)[zt]&&(t=(new Nt).compress(t)),localStorage.setItem(Ft(this,Ht)[Ht],t)):(Ft(this,$t)[$t]&&(t=btoa(encodeURIComponent(t))),Ft(this,ee)[ee](t))}function le(t){let e="",i=0,s=!1,r=0;for(;(0===i||s)&&i<Ft(this,Jt)[Jt];){let a=t+(i>0?i:"")+"=";if(document.cookie.length>0){let t=document.cookie.indexOf(a);if(-1!=t){t+=a.length;let o=document.cookie.indexOf(";",t);-1==o&&(o=document.cookie.length);let n=document.cookie.substring(t,o);if(n.length>0){if(0==i){let t=n.indexOf("@",0);r=n.substring(0,t),n=n.substr(t+1)}e+=n,s=!0}else s=!1}}i++}return e.length!=r?(console.error("Data is corrupt! - "+e.length+"vs"+r),Ft(this,ie)[ie](),null):e.length>0?e:null}function he(t){let e=new Date;e.setFullYear(e.getFullYear()+1),Ft(this,ie)[ie]();let i=0,s=t.length+"@"+t.substr(i,Ft(this,Yt)[Yt]);for(;s.length>0&&i<Ft(this,Jt)[Jt];)try{Ft(this,se)[se](i>0?Ft(this,Ht)[Ht]+i:Ft(this,Ht)[Ht],s,new Date(e),"/",Ft(this,Bt)[Bt],Ft(this,Vt)[Vt]),i++,s=t.substr(Ft(this,Yt)[Yt]*i,Ft(this,Yt)[Yt])}catch(t){console.debug(t.toString()),i=1e3}}function ce(){let t=new Date;t.setFullYear(t.getFullYear()-1);for(let e=0;e<4;e++)Ft(this,se)[se](Ft(this,Ht)[Ht]+(e>0?e:""),"",new Date(t),"/",Ft(this,Bt)[Bt],Ft(this,Vt)[Vt])}function de(t,e,i,s,r,a,o){void 0===a&&(a="Lax"),"None"===a&&(o=!0);var n=t+"="+e+(i?"; Expires="+i.toGMTString():"")+(s?"; Path="+s:"")+(r?"; Domain="+r:"")+(a?"; SameSite="+a:"")+(o?"; Secure":"");document.cookie=n}function ue(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var pe=0;function fe(t){return"__private_"+pe+++"_"+t}var ge=fe("channel");class ve{constructor(t=!1,e="domDetection2"){if(Object.defineProperty(this,ge,{writable:!0,value:""}),"domDetection"==e){var i=document.createElement("div");i.style.cssText="position: fixed;top: 0;left: 0;bottom: 0;right: 0;",document.documentElement.insertBefore(i,document.documentElement.firstChild);var s={width:i.offsetWidth,height:i.offsetHeight};console.debug(s);var r=s.width;ue(this,ge)[ge]=r<600?"mobile":"desktop",t&&r>=600&&(/ipad|android|tablet|kindle|silk|nook\s+browser|msie.+touch|xoom\s+build/i.test(navigator.userAgent)||"macintel"===navigator.platform.toLowerCase()&&void 0!==navigator.standalone)&&(ue(this,ge)[ge]="tablet"),document.documentElement.removeChild(i)}else{var a=navigator.userAgent.toLowerCase();-1===a.indexOf("mobile")&&a.indexOf("android")>-1||/(tablet|ipad|playbook|silk|kindle|nook\s+browser|msie.+touch|xoom\s+build)/i.test(a)||"macintel"===navigator.platform.toLowerCase()&&void 0!==navigator.standalone?ue(this,ge)[ge]=t?"tablet":"desktop":/Mobile|iP(hone|od)|Android.*Mobile|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/i.test(a)?ue(this,ge)[ge]="mobile":ue(this,ge)[ge]="desktop"}}getChannel(){return ue(this,ge)[ge]}}function be(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ye=0;function me(t){return"__private_"+ye+++"_"+t}var we=me("wordcount");class ke{constructor(t,e){if(Object.defineProperty(this,we,{writable:!0,value:0}),void 0!==e.wordCount)for(var i of Object.keys(e.wordCount.article))if("cl"==i)for(var s of Object.keys(e.wordCount.article[i]))for(var r=t.getElementsByClassName(s),a=0;a<r.length;a++)n=(n=r[a].textContent).replace(/\s+/g," "),1==e.wordCount.article.cl[s]?be(this,we)[we]+=n.split(" ").length-1:be(this,we)[we]-=n.split(" ").length-1;else if("el"==i)for(var o of Object.keys(e.wordCount.article[i]))for(r=t.getElementsByTagName(o),a=0;a<r.length;a++){var n;n=(n=r[a].textContent).replace(/\s+/g," "),1==e.wordCount.article.el[o]?be(this,we)[we]+=n.split(" ").length-1:be(this,we)[we]-=n.split(" ").length-1}}getWordcount(){return be(this,we)[we]}}function Oe(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Pe=0;function je(t){return"__private_"+Pe+++"_"+t}var De=je("paywallDetected");class Se{constructor(t,e){if(Object.defineProperty(this,De,{writable:!0,value:""}),null!=t&&void 0!==e.paywall&&void 0!==e.paywall.auto&&e.paywall.auto){if(void 0===e.paywall.element)return console.error("Paywall: missing element configuration"),!1;t.querySelectorAll(e.paywall.element).length>0&&(Oe(this,De)[De]="hard")}}getPaywall(){return Oe(this,De)[De]}}function Ae(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Te=0;function _e(t){return"__private_"+Te+++"_"+t}var Ee=_e("referer"),Ce=_e("qsps"),xe=_e("special"),Me=_e("getQSP");class Le{constructor(t,e){Object.defineProperty(this,Me,{value:Ie}),Object.defineProperty(this,Ee,{writable:!0,value:""}),Object.defineProperty(this,Ce,{writable:!0,value:["utm_source"]}),Object.defineProperty(this,xe,{writable:!0,value:{"facebook.com":["fbclid"]}}),void 0!==e.referer&&(Ae(this,Ce)[Ce]=e.referer);for(var i=0;i<Ae(this,Ce)[Ce].length;i++)if(void 0!==Ae(this,Ce)[Ce][i]&&""!=Ae(this,Ce)[Ce][i]&&!1!==(r=Ae(this,Me)[Me](Ae(this,Ce)[Ce][i]))&&""!==r){Ae(this,Ee)[Ee]=r;break}if(""===Ae(this,Ee)[Ee])for(var s of Object.keys(Ae(this,xe)[xe])){for(i=0;i<Ae(this,xe)[xe][s].length;i++){var r;if(!1!==(r=Ae(this,Me)[Me](Ae(this,xe)[xe][s][i]))){Ae(this,Ee)[Ee]=s;break}}if(""!==Ae(this,Ee)[Ee])break}""===Ae(this,Ee)[Ee]&&document.referrer&&""!==document.referrer&&(Ae(this,Ee)[Ee]=document.referrer),""===Ae(this,Ee)[Ee]&&(Ae(this,Ee)[Ee]="_")}getReferer(){return Ae(this,Ee)[Ee]}}function Ie(t){var e=t+"=",i=location.href.indexOf(e),s=-1;return i>-1&&(i+=e.length,-1==(s=location.href.indexOf("&",i))&&(s=location.href.indexOf("#",i)),s>-1?decodeURIComponent(location.href.substring(i,s)):decodeURIComponent(location.href.substr(i)))}function Ne(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Fe=0;function Ue(t){return"__private_"+Fe+++"_"+t}var Re=Ue("autoSection");class He{constructor(t,e){if(Object.defineProperty(this,Re,{writable:!0,value:""}),void 0!==e.autoSection&&e.autoSection&&""!==t){var i=new URL(t).pathname.split("/");i.length>2&&""!==i[1]&&(Ne(this,Re)[Re]=i[1].toLowerCase())}}getSection(){return Ne(this,Re)[Re]}}class qe{getMostVisibleElement(t){var e=window.innerHeight,i=0,s=null;for(var r of Array.from(t)){var a=r.getBoundingClientRect(),o=a.bottom-a.top,n={top:a.top>=0&&a.top<e,bottom:a.bottom>0&&a.bottom<e},l=0;if(n.top&&n.bottom)l=o;else if(n.top)l=e-a.top;else if(n.bottom)l=a.bottom;else if(o>e&&a.top<0){var h=Math.abs(a.top);h<o&&(l=o-h)}l>i&&(i=l,s=r)}return s}}function Ve(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Be=0;function Ke(t){return"__private_"+Be+++"_"+t}var ze=Ke("readK5AMeta"),$e=Ke("readLPMeta");class Ye{constructor(t,e){switch(Object.defineProperty(this,$e,{value:We}),Object.defineProperty(this,ze,{value:Je}),e){case"auto":!0!==Ve(this,ze)[ze](t)&&Ve(this,$e)[$e](t);break;case"LPMeta":Ve(this,$e)[$e](t);break;default:Ve(this,ze)[ze](t,e)}}}function Je(t,e="k5aMeta"){if(void 0!==window[e]){for(var i=t.getFields(),s=Object.keys(window[e]),r=0;r<i.length;r++)if(void 0!==window[e][i[r]])t.setField(i[r],window[e][i[r]]);else{for(var a=!1,o=0;o<s.length;o++)if((s[o].toLowerCase()==i[r].toLowerCase()||"referrer"==s[o].toLowerCase()&&"referer"==i[r].toLowerCase())&&void 0!==window[e][s[o]]){t.setField(i[r],window[e][s[o]]),a=!0;break}a||t.delField(i[r])}return!0}return!1}function We(t){if("undefined"!=typeof LPMeta){var e={url:"url",channel:"channel",image:"image",title:"title",section:"section",type:"type",tag:"tag",cTag:"cntTag",published_time:"publishtime",modified_time:"modifiedtime",paywalluser:"subscriber",paywall:"paid",wordcount:"wordcount",author:"author",conversion:"conversion",converted_user:"conversion",converteduser:"conversion"};for(var i in e)if(void 0!==LPMeta[i]&&""!==LPMeta[i])if("object"==typeof LPMeta[i])for(var s in LPMeta[i])t.setField(e[i],LPMeta[i][s].toLowerCase().trim());else t.setField(e[i],LPMeta[i]);return!0}return!1}function Ge(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Ze=0;function Qe(t){return"__private_"+Ze+++"_"+t}var Xe=Qe("domElement");class ti{constructor(t=null){Object.defineProperty(this,Xe,{writable:!0,value:null}),Ge(this,Xe)[Xe]=t}isTranslated(){return!!Ge(this,Xe)[Xe].querySelector("html.translated-ltr, html.translated-rtl, ya-tr-span, *[_msttexthash]")}}function ei(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ii=0;function si(t){return"__private_"+ii+++"_"+t}var ri=si("k5a"),ai=si("pageElm"),oi=si("artElm"),ni=si("cfg"),li=si("prefixes"),hi=si("pData"),ci=si("result"),di=si("initFBIAData"),ui=si("initArticleElement"),pi=si("autoMeta"),fi=si("convertField");class gi{constructor(t,e=document,i=null){var s;for(var r in Object.defineProperty(this,fi,{value:mi}),Object.defineProperty(this,pi,{value:yi}),Object.defineProperty(this,ui,{value:bi}),Object.defineProperty(this,di,{value:vi}),Object.defineProperty(this,ri,{writable:!0,value:null}),Object.defineProperty(this,ai,{writable:!0,value:null}),Object.defineProperty(this,oi,{writable:!0,value:null}),Object.defineProperty(this,ni,{writable:!0,value:{}}),Object.defineProperty(this,li,{writable:!0,value:["k5a","kilkaya","og","lp"]}),Object.defineProperty(this,hi,{writable:!0,value:{url:{type:"url",auto:function(){return location.href},fields:["url"],param:"u",spaSafe:!1},referer:{type:"string",auto:function(){return new Le(ei(this,ai)[ai],ei(this,ni)[ni]).getReferer()}.bind(this),fields:["referer","referrer"],param:"r",spaSafe:!0},title:{type:"string",fields:["title"],param:"ptl",spaSafe:!1},section:{type:"string",fields:["section","article:section"],auto:function(){return new He(this.getField("url"),ei(this,ni)[ni]).getSection()}.bind(this),param:"psn",spaSafe:!1,lc:!0},subsection:{type:"array",fields:["subsection","article:subsection"],param:"pssn",spaSafe:!1,lc:!0},type:{type:"string",fields:["type"],param:"ptp",spaSafe:!1,lc:!0},image:{type:"url",fields:["image"],param:"pig",spaSafe:!1},author:{type:"array",fields:["author","article:author"],param:"par",spaSafe:!1,lc:!0},tag:{type:"array",fields:["tag","article:tag"],param:"ptg",spaSafe:!1,lc:!0},cnttag:{type:"array",fields:["cntTag","article:cntTag"],param:"pctg",spaSafe:!1,lc:!0},contenttag:{type:"array",fields:["contentTag"],param:"pstg",spaSafe:!1,lc:!0},channel:{type:"string",fields:["channel"],auto:function(){return new ve(ei(this,ni)[ni].cntTablet||!1).getChannel()}.bind(this),param:"c",spaSafe:!0,undeleteAble:!0},wordcount:{type:"int",fields:["wordcount"],auto:function(){return new ke(ei(this,ai)[ai],ei(this,ni)[ni]).getWordcount()}.bind(this),param:"pwct",spaSafe:!1},publishtime:{type:"datetime",fields:["published_time","article:published_time"],param:"ppt",spaSafe:!1},modifiedtime:{type:"datetime",fields:["modified_time","article:modified_time"],param:"pmt",spaSafe:!1},paywall:{type:"string",fields:["paywall"],auto:function(){return new Se(ei(this,oi)[oi],ei(this,ni)[ni]).getPaywall()}.bind(this),param:"pw",spaSafe:!1},paid:{type:"boolean",fields:["paid"],auto:function(){if(ei(this,ni)[ni].paywall&&ei(this,ni)[ni].paywall.autoPaid&&("hard"==ei(this,ci)[ci].paywall||"h"==ei(this,ci)[ci].paywall))return!0}.bind(this),param:"pd",spaSafe:!1},login:{type:"boolean",fields:["login"],param:"ul",spaSafe:!0},subscriber:{type:"boolean",fields:["subscriber"],param:"sbs",spaSafe:!0},conversion:{type:"boolean",fields:["conversion"],param:"cs",spaSafe:!1},userid:{type:"string",fields:["userid","userId"],param:"",spaSafe:!0},subscriberid:{type:"string",fields:["subscriberid"],param:"sbid",spaSafe:!0},consent:{type:"boolean",fields:["consent"],param:"cst",auto:function(){return!0},spaSafe:!0}}}),Object.defineProperty(this,ci,{writable:!0,value:{}}),ei(this,ri)[ri]=t,ei(this,ai)[ai]=e,ei(this,ni)[ni]=i,void 0!==ei(this,ni)[ni].prefixes&&(ei(this,li)[li]=ei(this,ni)[ni].prefixes),ei(this,oi)[oi]=ei(this,ui)[ui](),ei(this,hi)[hi])ei(this,pi)[pi](r);void 0!==ei(this,ni)[ni].skipFBIA&&1===ei(this,ni)[ni].skipFBIA||"undefined"==typeof ia_document||ei(this,di)[di](),ei(this,ri)[ri].speaker.say("Init pagedata read (before jsonMetaData)","pagedata"),ei(this,ri)[ri].speaker.table(ei(this,ci)[ci],"pagedata"),new Ye(this,null!=(s=ei(this,ni)[ni].jsonMetaData)?s:"auto"),ei(this,ri)[ri].speaker.say("Init pagedata read:","pagedata"),ei(this,ri)[ri].speaker.table(ei(this,ci)[ci],"pagedata")}getArticleElement(){return ei(this,oi)[oi]===document?document.body:ei(this,oi)[oi]}reRead(){var t;ei(this,ri)[ri].speaker.say("ReRead called","pagedata");var e,i=!(!ei(this,ni)[ni].SPA||!ei(this,ni)[ni].SPA.metaData);if(i&&ei(this,ni)[ni].SPA&&"k5aMeta"==ei(this,ni)[ni].SPA.metaData&&"undefined"!=typeof k5aMeta)return this.resetAll(),new Ye(this,null!=(e=ei(this,ni)[ni].jsonMetaData)?e:"auto"),ei(this,ci)[ci].url&&""!==ei(this,ci)[ci].url||this.setField("url",ei(this,hi)[hi].url.auto()),ei(this,ri)[ri].speaker.say("Pagedata update - SPA (k5aMeta): "+location.href,"pagedata"),void ei(this,ri)[ri].speaker.table(ei(this,ci)[ci],"pagedata");let s=ei(this,ci)[ci].url;var r=(new qe).getMostVisibleElement(document.querySelectorAll(ei(this,ni)[ni].article));for(var a in ei(this,oi)[oi]=r,ei(this,hi)[hi])i||!i&&ei(this,hi)[hi][a].spaSafe?ei(this,pi)[pi](a):"url"==a?this.setField("url",location.href):ei(this,ci)[ci][a]="";new Ye(this,null!=(t=ei(this,ni)[ni].jsonMetaData)?t:"auto"),ei(this,ni)[ni].SPA&&ei(this,ni)[ni].SPA.skipConversion&&1==ei(this,ni)[ni].SPA.skipConversion&&this.resetField("conversion"),this.setField("paywall",ei(this,hi)[hi].paywall.auto()),this.setField("paid",ei(this,hi)[hi].paid.auto()),""==this.getField("referer")&&this.setField("referer",s),ei(this,ri)[ri].speaker.say("Pagedata update - SPA: "+location.href,"pagedata"),ei(this,ri)[ri].speaker.table(ei(this,ci)[ci],"pagedata")}setData(t){for(var e in t)this.setField(e,t[e])}setField(t,e){if(null!=e&&("referrer"==(t=t.toLowerCase())&&(t="referer"),void 0!==ei(this,hi)[hi][t]&&""!==e))switch(ei(this,hi)[hi][t].type){case"url":if(!ei(this,ni)[ni].forceRealUrl&&""!=e&&"/"!=e||"url"!=t){var i=this.isUrl(e);if(!1===i)throw new Error("given url is not valid: "+e);ei(this,ci)[ci][t]=i.trim()}else ei(this,ci)[ci][t]=ei(this,hi)[hi].url.auto();break;case"string":let a=e.trim();void 0!==ei(this,hi)[hi][t].lc&&ei(this,hi)[hi][t].lc&&(a=a.toLowerCase()),ei(this,ci)[ci][t]=a;break;case"array":if("object"==typeof e){for(var s in e)if(e.hasOwnProperty(s)&&void 0!==e[s]&&"undefined"!==e[s]&&null!==e[s]){let i=e[s].toString().trim();void 0!==ei(this,hi)[hi][t].lc&&ei(this,hi)[hi][t].lc&&(i=i.toLowerCase()),void 0===ei(this,ci)[ci][t]||""===ei(this,ci)[ci][t]?ei(this,ci)[ci][t]=[i]:ei(this,ci)[ci][t].includes(i)||ei(this,ci)[ci][t].push(i)}}else void 0!==e&&"undefined"!==e&&null!==e&&(e=e.toString().trim(),void 0!==ei(this,hi)[hi][t].lc&&ei(this,hi)[hi][t].lc&&(e=e.toLowerCase()),void 0===ei(this,ci)[ci][t]||""===ei(this,ci)[ci][t]?ei(this,ci)[ci][t]=[e]:ei(this,ci)[ci][t].includes(e)||ei(this,ci)[ci][t].push(e));break;case"boolean":ei(this,ci)[ci][t]="true"==e||1==e||"yes"==e||"1"==e?1:0;break;case"int":var r=parseInt(e);isNaN(r)||(ei(this,ci)[ci][t]=r);break;case"datetime":r=Date.parse(e),isNaN(r)||(ei(this,ci)[ci][t]=e)}}getField(t){return"domain"==t?new Tt(this.getField("url")).domain:(t=t.toLowerCase(),void 0!==ei(this,hi)[hi][t]&&void 0!==ei(this,ci)[ci][t]?ei(this,ci)[ci][t]:void 0!==ei(this,ci)[ci][t]&&""!=ei(this,ci)[ci][t]||void 0===ei(this,hi)[hi][t].auto?null:ei(this,hi)[hi][t].auto()||null)}delField(t){return void 0!==ei(this,hi)[hi][t]&&void 0!==ei(this,ci)[ci][t]&&void 0!==ei(this,hi)[hi][t].undeleteAble&&!ei(this,hi)[hi][t].undeleteAble&&(delete ei(this,ci)[ci][t],!0)}resetField(t){return!(void 0!==ei(this,hi)[hi][t].undeleteAble&&ei(this,hi)[hi][t].undeleteAble||void 0===ei(this,hi)[hi][t]||void 0===ei(this,ci)[ci][t]||(ei(this,ci)[ci][t]="",0))}resetAll(){var t=ei(this,ci)[ci].channel;ei(this,ci)[ci]=[],ei(this,ci)[ci].channel=t}getFields(){return Object.keys(ei(this,hi)[hi])}getData(){return ei(this,ci)[ci]}getLogData(t=null){var e={};null===t&&(t=Object.keys(ei(this,ci)[ci]));for(var i=0;i<t.length;i++)e[ei(this,hi)[hi][t[i]].param]=ei(this,ci)[ci][t[i]]?ei(this,ci)[ci][t[i]]:"";return e}getDefaultFields(){return["url","image","channel","type","section","subsection","title","wordcount","author","tag","cnttag","contenttag","publishtime","modifiedtime","paywall","paid","subscriber","conversion","referer","login"]}getDefaultData(){return this.getLogData(this.getDefaultFields())}isUrl(t){null!==t.match(/^\/\//i)?t=location.protocol+"//"+t:null===t.match(/^https?\:\/\//i)&&(t=location.protocol+"//"+location.hostname+t);try{var e=new URL(t,document.baseURI).href;e!==t&&(t=e)}catch(t){console.log(t.toString())}return(-1!==t.toLowerCase().indexOf("http://")||-1!==t.toLowerCase().indexOf("https://"))&&t}getMetaField(t,e=null){var i=ei(this,ai)[ai].querySelectorAll('meta[property="'+t+'"],meta[name="'+t+'"]');if(i&&i.length>0){for(var s=[],r=0;r<i.length;r++)if(i[r].hasAttribute("content")){var a=i[r].getAttribute("content");if("boolean"===e)return"1"==a||1==a||"yes"==a;null!==a&&""!=a&&s.push(a)}if(s.length>0)return s}return null}isTranslated(){return new ti(ei(this,ai)[ai]).isTranslated()}}function vi(){if("undefined"!=typeof ia_document){this.setField("url",ia_document.shareURL),this.setField("title",ia_document.title);var t=ia_document.referrer||"https://ia.facebook.com/";-1==t.indexOf("http")&&(t="https://"+t),this.setField("referer",t),this.setField("channel",this.getField("channel")+"_fbia")}}function bi(){if(ei(this,ni)[ni].article){var t=ei(this,ai)[ai].querySelector(ei(this,ni)[ni].article);if(null!==t)return t}return ei(this,ai)[ai]}function yi(t){this.resetField(t),ei(this,hi)[hi][t];for(var e=0;e<ei(this,hi)[hi][t].fields.length;e++)for(var i=0;i<ei(this,li)[li].length;i++){let o=-1==ei(this,hi)[hi][t].fields[e].indexOf(":")?ei(this,li)[li][i]+":"+ei(this,hi)[hi][t].fields[e]:ei(this,hi)[hi][t].fields[e];var s=ei(this,ai)[ai].querySelectorAll('meta[property="'+o+'"i],meta[name="'+o+'"i]');if(s&&s.length>0)for(var r=0;r<s.length;r++){var a=s[r].getAttribute("content");if(null!==a&&""!=a&&("lp"==ei(this,li)[li][i]&&(a=ei(this,fi)[fi](ei(this,li)[li][i],t,a)),""!==a&&(this.setField(t,a),void 0!==ei(this,ci)[ci][t]&&"array"!=ei(this,hi)[hi][t].type)))return}}void 0===ei(this,ci)[ci][t]&&void 0!==ei(this,hi)[hi][t].auto&&this.setField(t,ei(this,hi)[hi][t].auto())}function mi(t,e,i){if("lp"==t&&"paywall"==e){if("1"===i||"h"===i||"hard"===i)return this.setField("paid",!0),""}else{var s={lp:{paywall:{1:"hard",0:""}}};if(s[t]&&s[t][e]&&s[t][e][i])return s[t][e][i]}return i}function wi(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ki=0;function Oi(t){return"__private_"+ki+++"_"+t}var Pi=Oi("pingData"),ji=Oi("asyncTTL"),Di=Oi("reqIdHistory");class Si{constructor(t){this.k5a=null,Object.defineProperty(this,Pi,{writable:!0,value:{userActive:0,pings:[]}}),this.supportAsync=!1,Object.defineProperty(this,ji,{writable:!0,value:1e4}),Object.defineProperty(this,Di,{writable:!0,value:[]}),this.k5a=t}addHook(t,e,i=!1){this.k5a.listener.addHook(t,e,i)}addUserActiveHook(t,e,i){this.k5a.listener.addUserActiveHook(t,e,i)}isAutoEnabled(t){return void 0===this.k5a.cfg.moduleCfg[t]||void 0===this.k5a.cfg.moduleCfg[t].autoDisabled||!0!==this.k5a.cfg.moduleCfg[t].autoDisabled}addAsyncData(t,e,i){var s=this.k5a.storage.getKey("as");null===s&&(s={}),void 0===s[t]&&(s[t]={}),void 0===s[t][e]&&(s[t][e]=[]),i._reqId=this.k5a.requestId,s[t][e].push(i),this.k5a.storage.setKey("as",s,wi(this,ji)[ji])}getAsyncData(t){var e=this.k5a.storage.getKey("as");return null!==e&&void 0!==e[t]&&e[t]}runAsyncData(t,e,i=!1,s=!1){let r=this.k5a.requestId+"_"+t+"_"+e;if(wi(this,Di)[Di].indexOf(r)>-1)return void this.k5a.speaker.say("as sync with id '"+r+"' already done!");wi(this,Di)[Di].push(r);let a=this.k5a.storage.getKey("as"),o={};null!==a&&void 0!==a[t]&&(Object.keys(a).forEach((r=>{r===t?Object.keys(a[r]).forEach((n=>{if("*"===e||n===e)for(var l=0;l<a[t][n].length;l++)if(s||a[t][n][l]._reqId!==this.k5a.requestId)if(delete a[t][n][l]._reqId,i)try{var h=i(a[t][n][l]);!1!==h&&this.k5a.logger.fireNow(n,h,"storage")}catch(t){console.error(t.toString())}else this.k5a.logger.fireNow(n,a[t][n][l],"storage");else void 0===o[r]&&(o[r]={}),void 0===o[r][n]&&(o[r][n]=[]),o[r][n].push(a[t][n][l]),console.log("k5a: not running this AS data as we are on same requestId - "+a[t][n][l]._reqId+" vs k5a:"+this.k5a.requestId)})):Object.keys(a[r]).length>0&&(o[r]=a[r])})),Object.keys(o).length>0?this.k5a.storage.setKey("as",o,wi(this,ji)[ji]):this.k5a.storage.delKey("as"))}say(t){this.k5a.speaker.say(t,this.constructor.name)}warn(t){this.k5a.speaker.warn(t,this.constructor.name)}error(t){this.k5a.speaker.error(t,this.constructor.name)}clearAsyncData(t){}keysToLowerCase(t){var e={};return Object.keys(t).forEach((i=>{e[i.toLowerCase()]=t[i]})),e}}function Ai(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}Si.moduleName="logmodule";var Ti=0;function _i(t){return"__private_"+Ti+++"_"+t}var Ei=_i("pingInterval"),Ci=_i("userTTL"),xi=_i("lastActive"),Mi=_i("lastPing"),Li=_i("logData"),Ii=_i("intId"),Ni=_i("activities"),Fi=_i("stop"),Ui=_i("getTime");class Ri extends Si{constructor(t){super(t),Object.defineProperty(this,Ui,{value:qi}),Object.defineProperty(this,Fi,{value:Hi}),Object.defineProperty(this,Ei,{writable:!0,value:30}),Object.defineProperty(this,Ci,{writable:!0,value:60}),Object.defineProperty(this,xi,{writable:!0,value:0}),Object.defineProperty(this,Mi,{writable:!0,value:0}),Object.defineProperty(this,Li,{writable:!0,value:{}}),Object.defineProperty(this,Ii,{writable:!0,value:!1}),Object.defineProperty(this,Ni,{writable:!0,value:[]}),Ai(this,Li)[Li]=this.k5a.pageData.getDefaultData(),Ai(this,Li)[Li].uid=this.k5a.user.getId(),Ai(this,xi)[xi]=Ai(this,Ui)[Ui](),this.addHook("activity",function(t){Ai(this,xi)[xi]=Ai(this,Ui)[Ui](),this.start()}.bind(this)),this.addHook("hidden",function(t){Ai(this,Fi)[Fi]()}.bind(this),!0),this.addHook("active",function(t){Ai(this,xi)[xi]=Ai(this,Ui)[Ui](),this.checkActivity()}.bind(this),!0)}start(){!1===Ai(this,Ii)[Ii]&&(Ai(this,Ii)[Ii]=setInterval(function(){this.checkActivity()}.bind(this),1e3*Ai(this,Ei)[Ei]))}checkActivity(){var t=Ai(this,Ui)[Ui]();if(!(0!==Ai(this,Mi)[Mi]&&t-Ai(this,Mi)[Mi]<Ai(this,Ei)[Ei])){for(var e=!1,i=[],s=0;s<Ai(this,Ni)[Ni].length;s++)try{var r=Ai(this,Ni)[Ni][s]();if(!1!==r&&(e=!0,Ai(this,xi)[xi]=Ai(this,Ui)[Ui](),"object"==typeof r&&r.length>0))for(s=0;s<r.length;s++){var a=Ai(this,Li)[Li];Object.keys(r[s]).forEach((t=>{a[t]=r[s][t]})),i.push(a)}}catch(t){console.error("Could not call callback: "+t.toString())}if(!e&&t-Ai(this,xi)[xi]<=Ai(this,Ci)[Ci]&&!1!==Ai(this,Ii)[Ii]&&(e=!0),e){for(void 0!==this.k5a.cfg.activeUsers&&1==this.k5a.cfg.activeUsers&&i.push(Ai(this,Li)[Li]),s=0;s<i.length;s++)this.k5a.logger.fireNow("activity",i[s],"js");Ai(this,Mi)[Mi]=t}else this.k5a.listener.fireHook("hidden"),Ai(this,Fi)[Fi]()}}addActivity(t){Ai(this,Ni)[Ni].push(t)}}function Hi(){clearInterval(Ai(this,Ii)[Ii]),Ai(this,Ii)[Ii]=!1}function qi(){return parseInt((new Date).getTime()/1e3)}function Vi(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Bi=0;function Ki(t){return"__private_"+Bi+++"_"+t}var zi=Ki("length"),$i=Ki("data"),Yi=Ki("ttl"),Ji=Ki("defaultSessionTTL"),Wi=Ki("wasNewSession"),Gi=Ki("name"),Zi=Ki("store"),Qi=Ki("cannotStore"),Xi=Ki("UUID");class ts{constructor(t,e="u",i=16){Object.defineProperty(this,Xi,{value:is}),Object.defineProperty(this,Qi,{value:es}),Object.defineProperty(this,zi,{writable:!0,value:16}),Object.defineProperty(this,$i,{writable:!0,value:{}}),Object.defineProperty(this,Yi,{writable:!0,value:9e4}),Object.defineProperty(this,Ji,{writable:!0,value:1800}),Object.defineProperty(this,Wi,{writable:!0,value:!1}),this.k5a=null,Object.defineProperty(this,Gi,{writable:!0,value:"u"}),Object.defineProperty(this,Zi,{writable:!0,value:null}),this.k5a=t,Vi(this,zi)[zi]=i,Vi(this,Gi)[Gi]=e,t.consent&&this.k5a.storage.canStore()?(Vi(this,$i)[$i]=this.k5a.storage.getKey(e),null!==Vi(this,$i)[$i]?(Vi(this,Wi)[Wi]=Vi(this,$i)[$i].ts+Vi(this,Ji)[Ji]<parseInt((new Date).getTime()/1e3),Vi(this,$i)[$i].ts=parseInt((new Date).getTime()/1e3)):(Vi(this,Wi)[Wi]=!0,Vi(this,$i)[$i]={uid:Vi(this,Xi)[Xi](),ts:parseInt((new Date).getTime()/1e3)}),this.k5a.storage.setKey(Vi(this,Gi)[Gi],Vi(this,$i)[$i],Vi(this,Yi)[Yi])):Vi(this,Qi)[Qi]()}setId(t=""){return!(!this.k5a.consent||null===t.match(/^[a-zA-Z0-9\-\_\.]{4,128}$/)||(Vi(this,$i)[$i].uid=t,Vi(this,$i)[$i].ts=parseInt((new Date).getTime()/1e3),this.k5a.storage.setKey(Vi(this,Gi)[Gi],Vi(this,$i)[$i],Vi(this,Yi)[Yi]),0))}getId(){return Vi(this,$i)[$i].uid}getLastSeen(){return Vi(this,$i)[$i].ts}isNewSession(){return Vi(this,Wi)[Wi]}}function es(){Vi(this,$i)[$i].uid="_",Vi(this,Wi)[Wi]=!1}function is(){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=t.length,i=[],s=0;s<Vi(this,zi)[zi];s++)i[s]=t[0|Math.random()*e];return i.join("")}function ss(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var rs=0;function as(t){return"__private_"+rs+++"_"+t}var os=as("modules"),ns=as("insId"),ls=as("initializeModules"),hs=as("setupApiMethods"),cs=as("setupCustomCfg");function ds(){for(var t=0;t<this.cfg.modules.length;t++){var e=this.cfg.modules[t].moduleName;this.speaker.say('Loading module "'+e+'"');try{var i;ss(this,os)[os][e]=new this.cfg.modules[t](this,null!=(i=this.cfg.moduleCfg[e])?i:{}),"function"==typeof ss(this,os)[os][e].apiMethods&&ss(this,hs)[hs](ss(this,os)[os][e].apiMethods())}catch(e){this.speaker.say('Could not load log module: "'+this.cfg.modules[t]+'", reason: '+e.toString())}}}function us(t){Object.keys(t).forEach((e=>{this[e]=t[e]}))}function ps(){let t=["pageview","click","engagement","video"],e=this.pageData.getField("domain");if(void 0!==this.cfg){let e=!1;if(void 0===this.cfg.disableRefresh&&(this.cfg.disableRefresh=!0),0!==this.cfg.disableRefresh&&!1!==this.cfg.disableRefresh){let t=["refresh","autoRefresh","noLog"];"object"==typeof this.cfg.disableRefresh&&this.cfg.disableRefresh.length>0&&(t=this.cfg.disableRefresh);for(const i of t)if(this.pageData.getMetaField("k5a:"+i,"boolean")){e=!0;break}e||null===location.href.match(new RegExp("[#?&](?:"+t.join("|")+")","i"))||(this.speaker.say("Disabled via url parameter"),e=!0)}if(void 0!==this.cfg.disableBots&&void 0!==navigator.userAgent){let t=["bot","spider","scraper","bing","crawler","cxense","search","yandex","cookiebot"];if("object"==typeof this.cfg.disableBots&&this.cfg.disableBots.length>0)for(const e of this.cfg.disableBots)t.push(e);null!==navigator.userAgent.match(new RegExp(t.join("|"),"i"))&&(e=!0)}e&&t.forEach((t=>{void 0===this.cfg.moduleCfg[t]&&(this.cfg.moduleCfg[t]={}),this.cfg.moduleCfg[t].autoDisabled=!0,this.speaker.say("Module disabled via option: "+t)}))}"undefined"!=typeof k5aMeta&&Object.keys(k5aMeta).forEach((e=>{if(!0===k5aMeta[e]||1===k5aMeta[e]||"1"===k5aMeta[e]||"yes"===k5aMeta[e]){var i=e.substr(7).toLowerCase();t.includes(i)&&(this.speaker.say("Disabling "+i+" auto logging"),void 0===this.cfg.moduleCfg[i]?this.cfg.moduleCfg[i]={autoDisabled:!0}:this.cfg.moduleCfg[i].autoDisabled=!0)}})),t.forEach((t=>{void 0!==this.cfg.moduleCfg[t]&&void 0!==this.cfg.moduleCfg[t].disableFor&&this.cfg.moduleCfg[t].disableFor.includes(e)&&(this.speaker.say("Disabling "+t+' auto logging, "'+e+'" is banned in disableFor'),this.cfg.moduleCfg[t].autoDisabled=!0)}))}function fs(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var gs=0;function vs(t){return"__private_"+gs+++"_"+t}var bs=vs("logData"),ys=vs("spaHistory"),ms=vs("setupData"),ws=vs("apiPageview");class ks extends Si{constructor(t){super(t),Object.defineProperty(this,ws,{value:Ps}),Object.defineProperty(this,ms,{value:Os}),Object.defineProperty(this,bs,{writable:!0,value:{}}),Object.defineProperty(this,ys,{writable:!0,value:{}}),this.isAutoEnabled("pageview")&&(fs(this,ms)[ms](),this.addHook("pageView",function(t){t.persisted&&(fs(this,bs)[bs].ns=0),this.k5a.logger.addData("pageView",fs(this,bs)[bs])}.bind(this))),this.k5a.cfg.pageData.SPA&&this.addHook("spa",function(t){setTimeout(function(){this.k5a.speaker.say("I got a SPA pageview","pageview"),fs(this,ms)[ms](),fs(this,bs)[bs].ns=0,this.k5a.cfg.pageData.SPA.onlyOnce&&void 0!==fs(this,ys)[ys][fs(this,bs)[bs].u]?this.k5a.speaker.say("URL has already been recorded with pageview","pageview"):(this.k5a.logger.fireNow("pageView",fs(this,bs)[bs],"spa"),this.k5a.cfg.pageData.SPA.onlyOnce&&(fs(this,ys)[ys][fs(this,bs)[bs].u]=1))}.bind(this),this.k5a.cfg.pageData.SPA.viewTime&&this.k5a.cfg.pageData.SPA.viewTime>0?1e3*this.k5a.cfg.pageData.SPA.viewTime:1)}.bind(this),!0)}apiMethods(){return{pageview:function(t,e=!0){return fs(this,ws)[ws](t,e)}.bind(this)}}}function Os(){fs(this,bs)[bs]=this.k5a.pageData.getDefaultData(),fs(this,bs)[bs].uid=this.k5a.user.getId(),fs(this,bs)[bs].ns=this.k5a.user.isNewSession()?1:0}function Ps(t={},e=!0){var i={};if(t=this.keysToLowerCase(t),e){this.k5a.pageData.reRead();var s=this.k5a.pageData.getDefaultFields();if(void 0!==t.url&&!1===this.k5a.pageData.isUrl(t.url))throw new Error('Url is not valid: "'+t.url+'"');Object.values(s).forEach((e=>{void 0!==t[e]&&""!==t[e]&&this.k5a.pageData.setField(e,t[e])})),(i=this.k5a.pageData.getDefaultData()).uid=this.k5a.user.getId(),i.ns=this.k5a.user.isNewSession()?1:0,i.nopv=void 0!==t.nopv&&1==t.nopv?1:0}else{this.k5a.pageData.reRead();var r=this.k5a.pageData.getDefaultFields(),a=this.k5a.pageData.getField("channel");i={},Object.values(r).forEach((e=>{void 0!==t[e]&&""!==t[e]?this.k5a.pageData.setField(e,t[e]):this.k5a.pageData.delField(e)})),i=this.k5a.pageData.getDefaultData();var o={uid:"uid",newSession:"ns"};Object.keys(o).forEach((e=>{void 0!==t[e]&&""!==t[e]?i[o[e]]=t[e]:i[o[e]]="ns"==e?0:""})),""===i.c&&(i.c=a),i.nopv=void 0!==t.nopv&&1==t.nopv?1:0}return this.k5a.pageData.reRead(),this.k5a.logger.fireNow("pageView",i,"jsapi"),!0}function js(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}ks.moduleName="pageview";var Ds=0;function Ss(t){return"__private_"+Ds+++"_"+t}var As=Ss("slotCfg"),Ts=Ss("getSlot"),_s=Ss("get"),Es=Ss("getData"),Cs=Ss("getSize"),xs=Ss("getUrl"),Ms=Ss("autoSize"),Ls=Ss("getSlotMains"),Is=Ss("autoPos"),Ns=Ss("getElementPosition"),Fs=Ss("searchDataAtrs"),Us=Ss("getPos");class Rs{constructor(t=null){Object.defineProperty(this,Us,{value:Gs}),Object.defineProperty(this,Fs,{value:Ws}),Object.defineProperty(this,Ns,{value:Js}),Object.defineProperty(this,Is,{value:Ys}),Object.defineProperty(this,Ls,{value:$s}),Object.defineProperty(this,Ms,{value:zs}),Object.defineProperty(this,xs,{value:Ks}),Object.defineProperty(this,Cs,{value:Bs}),Object.defineProperty(this,Es,{value:Vs}),Object.defineProperty(this,_s,{value:qs}),Object.defineProperty(this,Ts,{value:Hs}),Object.defineProperty(this,As,{writable:!0,value:{}}),js(this,As)[As]=t,null==js(this,As)[As]&&(js(this,As)[As]={}),void 0===js(this,As)[As].slotUrl&&(js(this,As)[As].slotUrl={el:["a"]}),void 0===js(this,As)[As].dataUrlAttributes&&(js(this,As)[As].dataUrlAttributes=[]),-1==js(this,As)[As].dataUrlAttributes.indexOf("data-k5a-url")&&(js(this,As)[As].dataUrlAttributes=["data-k5a-url",...js(this,As)[As].dataUrlAttributes])}analyze(t){var e=js(this,Ts)[Ts](t);let i=!1;i=!1!==e&&e.querySelectorAll("[data-k5a-pos]").length<1?js(this,Is)[Is](e):{position:js(this,Us)[Us](t),row:0,pos:0};try{var s=js(this,Fs)[Fs](!1!==e?e:t)}catch(t){console.debug(t.toString())}var r={url:js(this,xs)[xs](t),size:0!=e?js(this,Cs)[Cs](e):"",image:void 0!==s.image&&""!==s.image?s.image:0!=e?js(this,_s)[_s](e,"image"):"",title:void 0!==s.title&&""!==s.title?s.title:0!=e?js(this,_s)[_s](e,"title"):"",row:i?i.row:0,pos:i?i.pos:0,position:i?i.position:js(this,Us)[Us](t),section:void 0!==s.section&&""!==s.section?s.section:"",type:void 0!==s.type&&""!==s.type?s.type:"",paid:void 0!==s.paid&&""!==s.paid?s.paid:""};return""!==r.url&&r}}function Hs(t){if(t.tagName&&"HTML"==t.tagName)return!1;if(!js(this,As)[As].slot)return!1;for(var e=0;t&&e++<50;){if(js(this,As)[As].slot.cl)for(var i=0;i<js(this,As)[As].slot.cl.length;i++)if(t.classList.contains(js(this,As)[As].slot.cl[i]))return t;if(js(this,As)[As].slot.el)for(i=0;i<js(this,As)[As].slot.el.length;i++)if(t.tagName.toLowerCase()==js(this,As)[As].slot.el[i].toLowerCase())return t;if(!t.parentNode||!t.parentNode.hasAttribute)return!1;t=t.parentNode}return!1}function qs(t,e){if(void 0===js(this,As)[As][e])return"";if(js(this,As)[As][e].cl)for(var i=0;i<js(this,As)[As][e].cl.length;i++)if((s=t.getElementsByClassName(js(this,As)[As][e].cl[i]))&&s.length>0)return js(this,Es)[Es](e,s[0]);if(js(this,As)[As][e].el)for(i=0;i<js(this,As)[As][e].el.length;i++){var s;if((s=t.getElementsByTagName(js(this,As)[As][e].el[i]))&&s.length>0)return js(this,Es)[Es](e,s[0])}return""}function Vs(t,e){let i=!1;switch(t){case"title":i=e.textContent;break;case"image":i=e.src}return void 0!==i&&!1!==i&&""!==i?i.trim():""}function Bs(t){if(void 0!==js(this,As)[As].slot.ss&&"auto"==js(this,As)[As].slot.ss)return js(this,Ms)[Ms](t)}function Ks(t){let e=0;for(;t.tagName&&"A"!=t.tagName&&e++<50;){for(let e=0;e<js(this,As)[As].dataUrlAttributes.length;e++)if(t.hasAttribute&&t.hasAttribute(js(this,As)[As].dataUrlAttributes[e])&&""!=t.getAttribute(js(this,As)[As].dataUrlAttributes[e]))return t.getAttribute(js(this,As)[As].dataUrlAttributes[e]);t=t.parentNode}if(t&&t.tagName&&"A"==t.tagName){for(let e=0;e<js(this,As)[As].dataUrlAttributes.length;e++)if(t.hasAttribute&&t.hasAttribute(js(this,As)[As].dataUrlAttributes[e])&&""!=t.getAttribute(js(this,As)[As].dataUrlAttributes[e]))return t.getAttribute(js(this,As)[As].dataUrlAttributes[e]);return t.href}return""}function zs(t){let e=t.clientWidth,i=t.parentNode.clientWidth;if(e>0&&i>0){let t=e/i;return t<=.33?"small":t<=.5?"medium":t<=.75?"large":"big"}}function $s(t){var e=!1,i=[];if(void 0!==js(this,As)[As].mains){for(var s=0;"BODY"!==t.tagName&&s++<50;){if(t.hasAttribute&&t.hasAttribute("data-k5a-topname")&&""!=t.getAttribute("data-k5a-topname"))return e=t.getAttribute("data-k5a-topname"),i.push(t),{topName:e,containers:i};for(var r of Object.keys(js(this,As)[As].mains)){if(t.tagName&&js(this,As)[As].mains[r].includes(t.tagName.toLowerCase())){e=r,i.push(t);break}if(t.hasAttribute&&t.hasAttribute("id")&&js(this,As)[As].mains[r].includes("#"+t.id)){e=r;break}if(t.hasAttribute&&t.hasAttribute("class")){var a=t.className.split(" ");for(var o of a)if(js(this,As)[As].mains[r].includes("."+o)){e=r,i.push(t);break}}}t&&t.parentNode&&(t=t.parentNode)}if(!1!==e)for(var n of js(this,As)[As].mains[e])if(n.indexOf("#")>-1){var l=document.getElementById(n.substr(1));null!=l&&i.push(l)}else{var h=document.getElementsByClassName(n);i.push(...h)}}return!1===e&&(e="",i.push(document.body)),{topName:e,containers:i}}function Ys(t){let{topName:e,containers:i}=js(this,Ls)[Ls](t),s=[];for(var r=0;r<i.length;r++)if(void 0!==js(this,As)[As].slot){let t=[];void 0!==js(this,As)[As].slot.cl&&t.push(...js(this,As)[As].slot.cl.map((function(t){return"."+t}))),void 0!==js(this,As)[As].slot.el&&t.push(...js(this,As)[As].slot.el.map((function(t){return t})));var a=i[r].querySelectorAll(t.join(","));s.push(...a)}var o=0,n=0,l=0,h=0,c=0;for(r=0;r<s.length;r++){var d=js(this,Ns)[Ns](s[r]);if((0==l||l+h<d.top)&&(l=parseInt(d.top),h=s[r].offsetHeight,o++,n=c=0),l==d.top&&s[r].offsetHeight>h&&(h=s[r].offsetHeight),(0==c||c<d.left)&&(c=d.left,n++),s[r]==t)return{row:o,pos:n,position:(""!=e?e+"_":"")+js(this,As)[As].positionTemplate.replace("${row}",o).replace("${pos}",n)}}return!1}function Js(t){var e=t.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY}}function Ws(t){if(t&&"A"!==t.tagName){let e=0;for(;++e<30&&null!==t&&"A"!==t.tagName;)t=t.parentNode}var e={};if(null===t)return e;var i={title:["data-k5a-title"],section:["data-k5a-section"],type:["data-k5a-type"],image:["data-k5a-image"],subsection:["data-k5a-subsection"],paid:["data-k5a-paid"]};for(let r of Object.keys(i)){e[r]="";for(let a=0;a<i[r].length;a++)if(t.hasAttribute&&t.hasAttribute(i[r][a])){var s=t.getAttribute(i[r][a]);if(""!==s){e[r]=s.trim();break}}}return e}function Gs(t){var e=[],i=["data-k5a-pos"];for(js(this,As)[As].dataAtrs&&js(this,As)[As].dataAtrs.length>0&&i.push(...js(this,As)[As].dataAtrs);t&&"BODY"!=t.tagName;){for(var s=!1,r=0;r<i.length&&!s;r++)t.hasAttribute&&t.hasAttribute(i[r])&&(e.push(t.getAttribute(i[r])),s=!0);if(!s&&js(this,As)[As].position){let i={id:"id",tagName:"el",class:"cl"};for(var a of Object.keys(js(this,As)[As].position))for(var o of Object.keys(i))if(void 0!==js(this,As)[As].position[a][i[o]]){var n="tagName"==o?t.tagName&&t.tagName.toLowerCase():t.getAttribute(o);"string"==typeof n&&""!==n&&null!==n.match("s*"+js(this,As)[As].position[a][i[o]].join("|")+"s*")&&(e.push(a),s=!0)}}if(!s&&js(this,As)[As].magicPositions)try{let i=new RegExp(js(this,As)[As].magicPositions).exec(t.className);i&&i.length>1&&""!==i[1]&&e.push(i[1])}catch(t){console.log(t.toString())}t=t.parentNode}return e.reverse().join("_")}function Zs(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Qs=0;function Xs(t){return"__private_"+Qs+++"_"+t}var tr=Xs("initTime"),er=Xs("apiClick");class ir extends Si{constructor(t,e={}){super(t),Object.defineProperty(this,er,{value:sr}),Object.defineProperty(this,tr,{writable:!0,value:0}),this.supportAsync=!0,Zs(this,tr)[tr]=(new Date).getTime(),this.isAutoEnabled("click")&&this.addHook("click",function(t){t&&t.button;try{var i=new Rs(e.slotInspector).analyze(t.srcElement)}catch(t){return void this.k5a.speaker.say(t.toString())}if(!1!==i&&new Tt(i.url).isLink){try{var s=this.k5a.pageData.getLogData(["url","channel","type","section","subsection","title","author","tag","cnttag","paid","referer"])}catch(t){console.log(t.toString())}new Tt(s.url);let t=this.k5a.pageData.isTranslated();this.k5a.speaker.say("Page is translated: "+t),s.tu=i.url,s.cr=i.row,s.cp=i.pos,s.po=i.position,s.ps=i.size,s.tptl=t?"":i.title,s.tpsn=i.section,s.tptp=i.type,s.tpig=i.image,s.tpd=i.paid,s.ct=(((new Date).getTime()-Zs(this,tr)[tr])/1e3).toFixed(1),this.k5a.logger.fireNow("click",s,"click","js"),Zs(this,tr)[tr]=(new Date).getTime()}}.bind(this),!0)}apiMethods(){return{click:function(t,e=!0){return Zs(this,er)[er](t,e)}.bind(this)}}}function sr(t,e=!0){var i=["url","channel","type","section","title","author","tag","cnttag","paid"],s={tourl:"tu",row:"cr",pos:"ps",position:"po",totitle:"tptl",tosection:"tpsn",totype:"tptp",totag:"tpct",tocnttag:"tpctg",toauthor:"tpar",topaid:"tpd"},r={};if(t=this.keysToLowerCase(t),e){if(this.k5a.pageData.reRead(),void 0!==t.url&&!1===this.k5a.pageData.isUrl(t.url))throw new Error('Url is not valid: "'+t.url+'"');Object.values(i).forEach((e=>{void 0!==t[e]&&""!==t[e]&&this.k5a.pageData.setField(e,t[e])})),r=this.k5a.pageData.getLogData(i),Object.keys(s).forEach((e=>{void 0!==t[e]&&""!==t[e]?r[s[e]]=t[e]:r[s[e]]=""}))}else r={},Object.values(i).forEach((e=>{void 0!==t[e]&&""!==t[e]?(this.k5a.pageData.setField(e,t[e]),r[e]=this.k5a.pageData.getField(e)):this.k5a.pageData.delField(e)})),Object.keys(s).forEach((e=>{void 0!==t[e]&&""!==t[e]?r[s[e]]=t[e]:r[s[e]]=""})),void 0!==r.c&&""!==r.c||(r.c=this.k5a.pageData.getField("channel"));return this.k5a.logger.fireNow("click",r,"jsapi"),!0}function rr(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}ir.moduleName="click";var ar=0;function or(t){return"__private_"+ar+++"_"+t}var nr=or("logModule"),lr=or("trackElements"),hr=or("iObserver"),cr=or("calc"),dr=or("calcVisibilty"),ur=or("calcTimeDifference");class pr{constructor(t){Object.defineProperty(this,ur,{value:vr}),Object.defineProperty(this,dr,{value:gr}),Object.defineProperty(this,cr,{value:fr}),Object.defineProperty(this,nr,{writable:!0,value:null}),Object.defineProperty(this,lr,{writable:!0,value:{}}),Object.defineProperty(this,hr,{writable:!0,value:null}),rr(this,nr)[nr]=t,rr(this,hr)[hr]=new IntersectionObserver(rr(this,cr)[cr].bind(this),{root:null,rootMargin:"0px",threshold:0}),rr(this,nr)[nr].addHook("scroll",function(t){rr(this,dr)[dr]()}.bind(this),!0)}stopAll(){for(var t of Object.keys(rr(this,lr)[lr]))for(var e=0;e<rr(this,lr)[lr][t].length;e++)rr(this,lr)[lr][t][e].initTime>0&&(rr(this,lr)[lr][t][e].visibleTime+=rr(this,ur)[ur](rr(this,lr)[lr][t][e].initTime),rr(this,lr)[lr][t][e].initTime=0,rr(this,lr)[lr][t][e].deadTime=(new Date).getTime())}startAll(){for(var t of Object.keys(rr(this,lr)[lr]))for(var e=0;e<rr(this,lr)[lr][t].length;e++)0==rr(this,lr)[lr][t][e].initTime&&(rr(this,lr)[lr][t][e].initTime=(new Date).getTime(),rr(this,lr)[lr][t][e].totalDeadTime+=rr(this,ur)[ur](rr(this,lr)[lr][t][e].deadTime),rr(this,lr)[lr][t][e].deadTime=0)}addTracker(t,e,i){void 0===rr(this,lr)[lr][t]&&(rr(this,lr)[lr][t]=[]);var s={trkId:t+"-"+rr(this,lr)[lr][t].length,elm:e,trkScroll:!(!i||!i.scroll)&&i.scroll,isVisible:!1,visbililty:0,maxVisibility:0,scroll:0,maxScroll:0,initTime:(new Date).getTime(),visibleTime:0,deadTime:0,totalDeadTime:0};rr(this,lr)[lr][t].push(s),e.setAttribute("data-k5a-trackerId",s.trkId),rr(this,hr)[hr].observe(e)}resetTracker(t,e,i){if(null!==e){if(void 0!==rr(this,lr)[lr][t]){for(var s=0;s<rr(this,lr)[lr][t].length;s++)null!==rr(this,lr)[lr][t][s].elm&&(rr(this,lr)[lr][t][s].elm.removeAttribute("data-k5a-trackerId"),rr(this,hr)[hr].unobserve(rr(this,lr)[lr][t][s].elm));rr(this,lr)[lr][t]=[]}this.addTracker(t,e,i)}}getData(t){for(var e=[],i=0;i<rr(this,lr)[lr][t].length;i++)(rr(this,lr)[lr][t][i].visibleTime>0||rr(this,lr)[lr][t][i].initTime)&&e.push({trackId:rr(this,lr)[lr][t][i].trkId,visible:rr(this,lr)[lr][t][i].visibleTime+rr(this,ur)[ur](rr(this,lr)[lr][t][i].initTime),maxScroll:rr(this,lr)[lr][t][i].maxScroll,scroll:rr(this,lr)[lr][t][i].scroll,elm:rr(this,lr)[lr][t][i].elm});return e}getAllData(){var t={};for(var e of Object.keys(rr(this,lr)[lr]))for(var i=0;i<rr(this,lr)[lr][e].length;i++)t[e]=this.getData(e);return t}debug(){for(var t of Object.keys(rr(this,lr)[lr]))for(var e=0;e<rr(this,lr)[lr][t].length;e++){var i=rr(this,lr)[lr][t][e];console.log(i.trkId+" "+i.isVisible+" "+i.maxScroll)}}}function fr(t){t.forEach((t=>{if(t.target.hasAttribute("data-k5a-trackerId")){var[e,i]=t.target.getAttribute("data-k5a-trackerId").split("-");t.isIntersecting?rr(this,lr)[lr][e][i].isVisible||(rr(this,lr)[lr][e][i].isVisible=!0,rr(this,lr)[lr][e][i].initTime=(new Date).getTime()):rr(this,lr)[lr][e][i].isVisible&&(rr(this,lr)[lr][e][i].isVisible=!1,rr(this,lr)[lr][e][i].visibleTime+=rr(this,ur)[ur](rr(this,lr)[lr][e][i].initTime))}}))}function gr(){var t=window.pageYOffset+window.innerHeight;for(var e of Object.keys(rr(this,lr)[lr]))for(var i=0;i<rr(this,lr)[lr][e].length;i++)if(rr(this,lr)[lr][e][i].trkScroll){var s=0;if("BODY"==rr(this,lr)[lr][e][i].elm.tagName){var r=document.documentElement.scrollTop,a=window.innerHeight,o=document.documentElement.scrollHeight;s=parseInt((r+a)/o*100)}else{var n=t-rr(this,lr)[lr][e][i].elm.offsetTop;s=parseInt(n/rr(this,lr)[lr][e][i].elm.offsetHeight*100)}s<0&&(s=0),s>100&&(s=100),s>rr(this,lr)[lr][e][i].maxScroll&&(rr(this,lr)[lr][e][i].maxScroll=s),rr(this,lr)[lr][e][i].scroll=s}}function vr(t){if(void 0===t||isNaN(t))return 0;var e=(new Date).getTime();return e>t&&e>0&&t>0?parseInt((e-t)/1e3):0}function br(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var yr=0;function mr(t){return"__private_"+yr+++"_"+t}var wr=mr("logData"),kr=mr("state"),Or=mr("elmTracker"),Pr=mr("cfg"),jr=mr("scrollMultiple"),Dr=mr("setupTrackElements"),Sr=mr("getExitType"),Ar=mr("finalizeExitData"),Tr=mr("setupLogData"),_r=mr("runDebug"),Er=mr("addTracker");class Cr extends Si{constructor(t,e={}){super(t),Object.defineProperty(this,Er,{value:Fr}),Object.defineProperty(this,_r,{value:Nr}),Object.defineProperty(this,Tr,{value:Ir}),Object.defineProperty(this,Ar,{value:Lr}),Object.defineProperty(this,Sr,{value:Mr}),Object.defineProperty(this,Dr,{value:xr}),Object.defineProperty(this,wr,{writable:!0,value:null}),Object.defineProperty(this,kr,{writable:!0,value:"active"}),Object.defineProperty(this,Or,{writable:!0,value:null}),Object.defineProperty(this,Pr,{writable:!0,value:{}}),Object.defineProperty(this,jr,{writable:!0,value:5}),!0===this.isAutoEnabled("engagement")&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&(void 0!==this.k5a.cfg.pageData.article&&"article"==this.k5a.pageData.getField("type")&&(e.elements.page=this.k5a.cfg.pageData.article),br(this,Pr)[Pr]=e,void 0===br(this,Pr)[Pr].maxTime&&(br(this,Pr)[Pr].maxTime=86400),br(this,Tr)[Tr](),"object"==typeof e.elements&&this.addHook("ready",function(t){br(this,Dr)[Dr](e.elements),br(this,kr)[kr]="active",br(this,Or)[Or].startAll()}.bind(this)),this.addHook("activity",function(t){br(this,kr)[kr]="active",br(this,Or)[Or].startAll()}.bind(this),!0),this.addHook("hidden",function(t){br(this,Or)[Or].stopAll(),br(this,kr)[kr]="hidden"}.bind(this),!0),this.k5a.cfg.pageData.SPA&&this.addHook("spa",function(t){try{if(t&&t.detail&&null==t.detail.sourceUrl)return;br(this,Ar)[Ar](),br(this,wr)[wr].evt>0&&br(this,wr)[wr].evt<br(this,Pr)[Pr].maxTime&&(this.k5a.logger.fireNow("exit",br(this,wr)[wr],"spa",br(this,Sr)[Sr](t)),this.say("exit log request sent, type 'spa' ")),br(this,Or)[Or].resetTracker("page",this.k5a.pageData.getArticleElement(),{scroll:!0}),br(this,Tr)[Tr]()}catch(t){console.error("Engagement spa error:"),console.debug(t)}}.bind(this),!0),this.addHook("exit",function(t){br(this,Ar)[Ar](),this.k5a.speaker.dump(br(this,wr)[wr]),br(this,wr)[wr].evt>0&&br(this,wr)[wr].evt<=br(this,Pr)[Pr].maxTime&&(this.k5a.logger.fireNow("exit",br(this,wr)[wr],"js",br(this,Sr)[Sr](t)),this.say("exit log request sent, type 'js' "))}.bind(this),!0),this.addHook("pageView",function(t){this.say("Engagemanet pageview recieved"),br(this,Tr)[Tr]()}.bind(this),!0))}apiMethods(){return{addTracker:function(t,e,i=!1){return br(this,Er)[Er](t,e,i)}.bind(this)}}}function xr(t){for(var e of(br(this,Or)[Or]=new pr(this),Object.keys(t)))switch(e){case"slots":document.querySelectorAll(t[e]).forEach((t=>{br(this,Or)[Or].addTracker(e,t,{scroll:!1})}));break;case"page":case"toolbar":var i=document.body;if(""!==t[e]){var s=document.querySelector(t[e]);null!==s&&(i=s)}br(this,Or)[Or].addTracker(e,i,{scroll:!0})}}function Mr(t){return("click"===this.k5a.listener.getExitType()?"c":"")+"exit"}function Lr(){var t=br(this,Or)[Or].getAllData();for(var e of(br(this,wr)[wr].tids=[],Object.keys(t)))t[e].length>0&&("page"==e?(br(this,wr)[wr].evt=parseInt(t[e][0].visible),br(this,wr)[wr].eeh=t[e][0].scroll,br(this,wr)[wr].ems=t[e][0].maxScroll,br(this,wr)[wr].tids=[]):br(this,wr)[wr].tids.push(e+"|"+t[e][0].visible+"|"+t[e][0].maxScroll+"|"+t[e][0].scroll))}function Ir(){this.say("setupLogData called: "),br(this,wr)[wr]=this.k5a.pageData.getDefaultData(),this.say("logData now:"+JSON.stringify(br(this,wr)[wr]))}function Nr(){if(!0===this.k5a.speaker.debugMode){var t=document.getElementById("engangementDebug");null===t&&((t=document.createElement("DIV")).id="engangementDebug",t.style="background:grey;color:white;padding:5px;position:fixed;top:10px;right:10px;min-width:300px;min-height:20px;font-size:12px;opacity:0.90;",document.body.appendChild(t))}}function Fr(t,e,i=!1){null===br(this,Or)[Or]&&(br(this,Or)[Or]=new pr(this)),br(this,Or)[Or].addTracker(t,e,{scroll:i})}function Ur(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}Cr.moduleName="engagement";var Rr=0;function Hr(t){return"__private_"+Rr+++"_"+t}var qr=Hr("video"),Vr=Hr("vData"),Br=Hr("startTime"),Kr=Hr("viewTime"),zr=Hr("autoLoadSent"),$r=Hr("debugMode"),Yr=Hr("startSent"),Jr=Hr("stopSent"),Wr=Hr("reviseMetaData"),Gr=Hr("sendVideoLoad"),Zr=Hr("sendVideoStart"),Qr=Hr("sendVideoStop"),Xr=Hr("testField"),ta=Hr("log"),ea=Hr("debug"),ia=Hr("error");class sa{constructor(t,e,i=!0,s=null){Object.defineProperty(this,ia,{value:da}),Object.defineProperty(this,ea,{value:ca}),Object.defineProperty(this,ta,{value:ha}),Object.defineProperty(this,Xr,{value:la}),Object.defineProperty(this,Qr,{value:na}),Object.defineProperty(this,Zr,{value:oa}),Object.defineProperty(this,Gr,{value:aa}),Object.defineProperty(this,Wr,{value:ra}),Object.defineProperty(this,qr,{writable:!0,value:void 0}),Object.defineProperty(this,Vr,{writable:!0,value:{vid:{type:"string",rule:"^[0-9A-Za-z:/x",param:"vid",value:""},duration:{type:"integer",param:"drn",rule:"^\\d+$",value:0},roll:{type:"array",param:"rls",rule:"^\\w{3,32}$",value:[],persistent:!1},tag:{type:"array",param:"vtg",rule:"^\\w{2,32}$",value:[]},countabletag:{type:"array",param:"vctg",rule:"^\\w{2,32}$",value:[],persistent:!1},viewTime:{type:"integer",rule:"^\\d+$",param:"vvt",value:0},start:{type:"string",param:"vst",rule:"^(?:auto|manual|nextauto|nextmanual|restart)$",value:"auto"},title:{type:"string",param:"vtl",rule:"^.{1,256}$",value:""},image:{type:"string",param:"vig",rule:"^[^\\s]{5,256}$",value:""},published:{type:"string",param:"vpt",rule:"^[0-9-T:.Z]+$",value:""},modified:{type:"string",param:"vmt",rule:"^[0-9-T:.Z]+$",value:""},section:{type:"string",param:"vpsn",rule:"^.{2,256}$",value:""},subsection:{type:"array",param:"vpssn",rule:"^.{2,256}$",value:[]},paid:{type:"boolean",param:"vpd",rule:"",value:""},paywall:{type:"string",param:"vpw",rule:"^(?:hard|metered|open)$",value:"open",persistent:!1},login:{type:"boolean",param:"vul",rule:"",value:"",persistent:!1},subscriber:{type:"boolean",param:"vsbs",rule:"",value:"",persistent:!1}}}),Object.defineProperty(this,Br,{writable:!0,value:-1}),Object.defineProperty(this,Kr,{writable:!0,value:0}),Object.defineProperty(this,zr,{writable:!0,value:!1}),Object.defineProperty(this,$r,{writable:!0,value:!1}),Object.defineProperty(this,Yr,{writable:!0,value:!1}),Object.defineProperty(this,Jr,{writable:!0,value:!1}),Ur(this,qr)[qr]=t,Ur(this,Vr)[Vr].vid.value=e,null!=s&&Object.keys(s).forEach((t=>{this.setField(t,s[t])})),i&&this.load()}setDebugMode(t=!0){Ur(this,$r)[$r]!==t&&(Ur(this,$r)[$r]&&!1===t&&Ur(this,ta)[ta]("Setting debug mode off","info"),Ur(this,$r)[$r]=!!t,Ur(this,$r)[$r]&&!0===t&&(Ur(this,qr)[qr].k5a.speaker.setDebugModeModule("video"),Ur(this,ta)[ta]("Setting debug mode on","info")))}getDebugMode(){return Ur(this,$r)[$r]}setLive(){Ur(this,ta)[ta]("set to live video","info"),Ur(this,Vr)[Vr].duration.value=0}setField(t,e){if(t=t.toLowerCase().trim(),Ur(this,Xr)[Xr](t,e))switch(Ur(this,ta)[ta]('setField: "'+t+'" -> "'+e+'"',"info"),Ur(this,Vr)[Vr][t].type){case"string":case"integer":Ur(this,Vr)[Vr][t].value=e;break;case"boolean":Ur(this,Vr)[Vr][t].value="true"===e||!0===e||1===e||"1"===e?1:0;break;case"array":Ur(this,Vr)[Vr][t].value.includes(e)||Ur(this,Vr)[Vr][t].value.push(e)}else Ur(this,ta)[ta]('setField - could not set "'+t+'" to "'+e+'"',"error");return!1}getField(t){return void 0!==Ur(this,Vr)[Vr][t]?Ur(this,Vr)[Vr][t].value:null}load(){!1===Ur(this,zr)[zr]?(Ur(this,zr)[zr]=!0,Ur(this,Gr)[Gr]()):Ur(this,ta)[ta]("Load already sent","warn")}start(t="auto"){return-1!==Ur(this,Br)[Br]||Ur(this,Yr)[Yr]?(Ur(this,ta)[ta]("Start already sent","error"),!1):Ur(this,Xr)[Xr]("start",t)?(Ur(this,ta)[ta]("start - startType: "+t,"info"),Ur(this,Vr)[Vr].start.value=t,Ur(this,Br)[Br]=(new Date).getTime(),void Ur(this,Zr)[Zr]()):(Ur(this,ta)[ta]('invalid start type given: "'+t+'"',"error"),!1)}isPlaying(){return Ur(this,Br)[Br]>0}pause(){return Ur(this,Br)[Br]<1?(Ur(this,ta)[ta]("- pause: video is not playing","error"),!1):(Ur(this,ta)[ta]("set to pause","info"),Ur(this,Kr)[Kr]+=(new Date).getTime()-Ur(this,Br)[Br],Ur(this,Br)[Br]=0,!0)}resume(){return 0===Ur(this,Br)[Br]&&Ur(this,Yr)[Yr]?(Ur(this,ta)[ta]("resuming video","info"),Ur(this,Br)[Br]=(new Date).getTime(),!0):(Ur(this,ta)[ta]("video is not paused or started","error"),!1)}stop(){if(Ur(this,Jr)[Jr])return Ur(this,ta)[ta]("stop - video stop already sent","info"),!1;if(this.isPlaying()){let t=Ur(this,$r)[$r];Ur(this,$r)[$r]=!1,this.pause(),Ur(this,$r)[$r]=t}if(!Ur(this,Yr)[Yr])return Ur(this,ta)[ta]("stop - video was never started","info"),!1;if(Ur(this,Kr)[Kr]<1)return!1;Ur(this,Vr)[Vr].viewTime.value=parseInt(Ur(this,Kr)[Kr]/1e3);let t=Ur(this,Qr)[Qr]();return Ur(this,Br)[Br]=-1,Ur(this,Vr)[Vr].viewTime.value=0,t?Ur(this,ta)[ta]("stop - video stopped","info"):Ur(this,ta)[ta]("stop - video stop already sent","info"),t}restart(t="restart"){this.stop(),Ur(this,Yr)[Yr]=!1,Ur(this,Jr)[Jr]=!1,Ur(this,Br)[Br]=-1,Ur(this,Kr)[Kr]=0,this.start(t)}dump(){console.debug(Ur(this,Vr)[Vr]),this.getLogData()}getLogData(){var t=Ur(this,qr)[qr].k5a.pageData.getDefaultData();return Object.keys(Ur(this,Vr)[Vr]).forEach((e=>{t[Ur(this,Vr)[Vr][e].param]=Ur(this,Vr)[Vr][e].value})),t.uid=Ur(this,qr)[qr].k5a.user.getId(),t}}function ra(){Object.keys(Ur(this,Vr)[Vr]).forEach((t=>{void 0!==Ur(this,Vr)[Vr][t].persistent&&!1===Ur(this,Vr)[Vr][t].persistent&&("array"===Ur(this,Vr)[Vr][t].type?Ur(this,Vr)[Vr][t].value=[]:Ur(this,Vr)[Vr][t].value="")}))}function aa(){var t=this.getLogData();t.vst="load",Ur(this,qr)[qr].k5a.logger.fireNow("video",t,"js"),Ur(this,Wr)[Wr]()}function oa(){Ur(this,Yr)[Yr]||(Ur(this,Yr)[Yr]=!0,Ur(this,qr)[qr].k5a.logger.fireNow("video",this.getLogData(),"js"),Ur(this,Wr)[Wr]())}function na(){if(!Ur(this,Jr)[Jr]&&Ur(this,Yr)[Yr]){Ur(this,Jr)[Jr]=!0;var t=this.getLogData();return t.vst="stop",Ur(this,qr)[qr].k5a.logger.fireNow("video",t,"js"),Ur(this,Wr)[Wr](),!0}return!1}function la(t,e){if(void 0===Ur(this,Vr)[Vr][t])return!1;if("boolean"===Ur(this,Vr)[Vr][t].type)return"true"===e||!0===e||1===e||"1"===e||"false"===e||!1===e||0===e||"0"===e;var i=void 0!==Ur(this,Vr)[Vr][t].rule&&""!=Ur(this,Vr)[Vr][t].rule&&new RegExp(Ur(this,Vr)[Vr][t].rule);return!1===i||!1!==i.test(e)}function ha(t,e="info"){Ur(this,$r)[$r]&&Ur(this,qr)[qr].say({prefix:"["+Ur(this,Vr)[Vr].vid.value+"]",message:t,type:e,module:"video"})}function ca(t){if(Ur(this,$r)[$r]){let e="font-weight:bold;color:#284352;";console.log("%cK5A Video2["+Ur(this,Vr)[Vr].vid.value+"]:%c"+t+" startTime: "+Ur(this,Br)[Br]+" viewTime: "+Ur(this,Kr)[Kr],e,"")}}function da(t,e){}function ua(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var pa=0;function fa(t){return"__private_"+pa+++"_"+t}var ga=fa("activeVideos"),va=fa("debugMode");class ba extends Si{constructor(t){super(t),Object.defineProperty(this,ga,{writable:!0,value:{}}),Object.defineProperty(this,va,{writable:!0,value:!1}),ua(this,va)[va]=this.k5a.speaker.getDebugModeModule("video"),this.addHook("exit",function(t){this.say("I got exit...."),Object.keys(ua(this,ga)[ga]).forEach((t=>{null!==ua(this,ga)[ga][t]&&(x,this.finishVideo(ua(this,ga)[ga][t]))}))}.bind(this)),this.k5a.active.addActivity(function(){var t=[];return Object.keys(ua(this,ga)[ga]).forEach((e=>{null!==ua(this,ga)[ga][e]&&ua(this,ga)[ga][e].isPlaying()&&t.push(ua(this,ga)[ga][e].getLogData())})),t.length>0&&t}.bind(this))}setDebugMode(t=!0){ua(this,va)[va]=!!t}finishVideo(t){try{var e=t.getField("vid")}catch(t){return!1}return void 0!==ua(this,ga)[ga][e]?!1!==t.stop()||(this.warn("Could not stop video with id: "+e),!1):(this.error("Unknown video instance"),!1)}apiMethods(){return{getVideo:function(t,e=!0,i=null){if(void 0!==ua(this,ga)[ga][t])return this.say("Video object already initialized - reusing object","video"),ua(this,ga)[ga][t];{this.say("Initializing Video object with id: '"+t+"'");let s=new sa(this,t,e,i);return s.setDebugMode(ua(this,va)[va]),ua(this,ga)[ga][t]=s,s}}.bind(this),finishVideo:function(t){this.finishVideo(t)}.bind(this),setVideoDebug:function(t=!0){this.setDebugMode(t)}.bind(this)}}}ba.moduleName="video";var ya=new class{constructor(t,e=!1){Object.defineProperty(this,cs,{value:ps}),Object.defineProperty(this,hs,{value:us}),Object.defineProperty(this,ls,{value:ds}),this.cfg={},Object.defineProperty(this,os,{writable:!0,value:{}}),this.speaker=null,this.logger=null,this.storage=null,this.k5aServer="//l.kilkaya.com/",Object.defineProperty(this,ns,{writable:!0,value:""}),this.element=document,this.pageData=null,this.user=null,this.consent=!0,this.requestId=(new Date).getTime(),this.cfg=t,["installationId","logServer","logscript_commitsha","modules"].forEach((t=>{void 0===this.cfg[t]&&console.error("K5A: missing config option: '"+t+"'")})),void 0===this.cfg.moduleCfg&&(this.cfg.moduleCfg={}),void 0!==this.cfg.logServer&&(this.k5aServer=this.cfg.logServer),this.speaker=new tt(this,e),this.storage=new re(this),this.speaker.checkPersistentDebugMode(),this.logger=new kt(this),this.pageData=new gi(this,this.element,this.cfg.pageData||{}),this.listener=new S(this),this.consent=this.pageData.getField("consent"),!1===this.cfg.hasConsent&&(this.consent=!1),this.user=new ts(this),this.user.setId(this.pageData.getField("userId")||""),this.active=new Ri(this),ss(this,cs)[cs](),ss(this,ls)[ls](),this.listener.postInitialize()}debugModeOn(){this.speaker.setPersistentDebugMode(!0)}debugModeOff(){this.speaker.setPersistentDebugMode(!1)}devModeOn(){this.speaker.setPersistentDebugMode(!0,!0)}devModeOff(){this.speaker.setPersistentDebugMode(!1)}set debugMode(t=!1){this.speaker.debugMode(t)}set debugUrl(t=!1){this.speaker.debugUrl(t)}disableLog(){this.logger.disable()}enableLog(){this.logger.enable()}resetRequestId(){this.requestId=(new Date).getTime()}}({installationId:"618112c1d5dcb06e487079f2",logServer:"https://cl-eu2.k5a.io/",logscript_commitsha:"generation2",domains:["nrk.no","p3.no","nrksuper.no","ut.no","nrkbeta.no","k5a.io"],modules:[ks,ir,Cr,ba],pageData:{article:["article"],referer:["utm_medium","utm_source"],wordCount:{article:{el:{article:1}}}},moduleCfg:{pageview:{ping:!0},engagement:{elements:{page:"document",toolbar:"auto"}},click:{slotInspector:{position:{header:{el:["header"]},footer:{el:["footer"]}},mains:{main:["main"]},slot:{cl:["kur-room"],ss:"auto"},title:{el:["h2"]},image:{el:["img"]},positionTemplate:"row${row}_pos${pos}"}}}},-1!==location.href.indexOf("k5aDebug"));window.kilkaya=ya})();